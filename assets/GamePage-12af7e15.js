var Je=Object.defineProperty;var Ke=(t,e,a)=>e in t?Je(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var N=(t,e,a)=>(Ke(t,typeof e!="symbol"?e+"":e,a),a),je=(t,e,a)=>{if(!e.has(t))throw TypeError("Cannot "+a)};var le=(t,e,a)=>(je(t,e,"read from private field"),a?a.call(t):e.get(t)),Le=(t,e,a)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,a)};import{b as Z,s as P,r as d,x as ze,o as m,d as h,u as s,c as D,w as Ze,y as W,R as qe,f as o,a as ce,h as O,F as U,m as Te,A as Qe,n as M,i as q,t as V,e as J,v as K,j as I,g as G,k as Y,_ as ee,p as Xe,q as Oe,B as De,z as re,C as Ye,D as et,E as tt,G as at,l as st,H as nt}from"./index-0d521d25.js";import{b as rt,u as ae}from"./fetch-5f5bc1cf.js";import{L as Be,_ as it}from"./loadingAuth-3286095e.js";import{_ as ot,a as lt}from"./yes_login-65e1999f.js";import{_ as ut}from"./close-ed01941b.js";var se;class mt{constructor(e){Le(this,se,Z());this.nameP1=P(()=>{var a;return((a=le(this,se).users.P1)==null?void 0:a.name)||d((e==null?void 0:e.nameP1)||"Игрок 1")}),this.nameP2=P(()=>{var a;return((a=le(this,se).users.P2)==null?void 0:a.name)||d((e==null?void 0:e.nameP2)||"Игрок 2")}),this.startRemainder=d((e==null?void 0:e.startRemainder)||501),this.whoStarts=d((e==null?void 0:e.whoStarts)||"nameP1"),this.legsToWin=d((e==null?void 0:e.legsToWin)||1),this.setsToWin=d((e==null?void 0:e.setsToWin)||1),this.areSetsInGame=d((e==null?void 0:e.areSetsInGame)||!1),this.isPercentDoubleInStatP1=d((e==null?void 0:e.isPercentDoubleInStatP1)||!1),this.isPercentDoubleInStatP2=d((e==null?void 0:e.isPercentDoubleInStatP2)||!1)}normalize(){const e={};for(const a in this)e[a]=this[a].value;if(e.nameP1.value&&(e.nameP1=e.nameP1.value),e.nameP2.value&&(e.nameP2=e.nameP2.value),e.whoStarts==="nameP2"){const a=e.isPercentDoubleInStatP1;e.isPercentDoubleInStatP1=e.isPercentDoubleInStatP2,e.isPercentDoubleInStatP2=a;const n=e.nameP1;e.nameP1=e.nameP2,e.nameP2=n}return e}}se=new WeakMap;const ct=(t,e,a,n)=>{const i=t.normalize();i.whoStarts==="nameP2"&&(e.swap(),a()),localStorage.setItem("gameParameters",JSON.stringify(i)),n("startGame",i)},dt=()=>{if(localStorage.getItem("userP1")&&localStorage.getItem("userP2")){const t=localStorage.getItem("userP1");localStorage.setItem("userP1",localStorage.getItem("userP2")),localStorage.setItem("userP2",t)}if(localStorage.getItem("userP1")&&!localStorage.getItem("userP2")?(localStorage.setItem("userP2",localStorage.getItem("userP1")),localStorage.removeItem("userP1")):!localStorage.getItem("userP1")&&localStorage.getItem("userP2")&&(localStorage.setItem("userP1",localStorage.getItem("userP2")),localStorage.removeItem("userP2")),localStorage.getItem("seenAveragePointsLegP2")&&localStorage.getItem("seenAveragePointsLegP1")){const t=localStorage.getItem("seenAveragePointsLegP1");localStorage.setItem("seenAveragePointsLegP1",localStorage.getItem("seenAveragePointsLegP2")),localStorage.setItem("seenAveragePointsLegP2",t)}if(localStorage.getItem("seenAveragePointsLegP1")&&!localStorage.getItem("seenAveragePointsLegP2")?(localStorage.setItem("seenAveragePointsLegP2",localStorage.getItem("seenAveragePointsLegP1")),localStorage.removeItem("seenAveragePointsLegP1")):!localStorage.getItem("seenAveragePointsLegP1")&&localStorage.getItem("seenAveragePointsLegP2")&&(localStorage.setItem("seenAveragePointsLegP1",localStorage.getItem("seenAveragePointsLegP2")),localStorage.removeItem("seenAveragePointsLegP2")),localStorage.getItem("seenParametersSetP2")&&localStorage.getItem("seenParametersSetP1")){const t=localStorage.getItem("seenParametersSetP1");localStorage.setItem("seenParametersSetP1",localStorage.getItem("seenParametersSetP2")),localStorage.setItem("seenParametersSetP2",t)}if(localStorage.getItem("seenParametersSetP1")&&!localStorage.getItem("seenParametersSetP2")?(localStorage.setItem("seenParametersSetP2",localStorage.getItem("seenParametersSetP1")),localStorage.removeItem("seenParametersSetP1")):!localStorage.getItem("seenParametersSetP1")&&localStorage.getItem("seenParametersSetP2")&&(localStorage.setItem("seenParametersSetP1",localStorage.getItem("seenParametersSetP2")),localStorage.removeItem("seenParametersSetP2")),localStorage.getItem("seenParametersGameP2")&&localStorage.getItem("seenParametersGameP1")){const t=localStorage.getItem("seenParametersGameP1");localStorage.setItem("seenParametersGameP1",localStorage.getItem("seenParametersGameP2")),localStorage.setItem("seenParametersGameP2",t)}localStorage.getItem("seenParametersGameP1")&&!localStorage.getItem("seenParametersGameP2")?(localStorage.setItem("seenParametersGameP2",localStorage.getItem("seenParametersGameP1")),localStorage.removeItem("seenParametersGameP1")):!localStorage.getItem("seenParametersGameP1")&&localStorage.getItem("seenParametersGameP2")&&(localStorage.setItem("seenParametersGameP1",localStorage.getItem("seenParametersGameP2")),localStorage.removeItem("seenParametersGameP2"))},gt="/darts-calculator/assets/no_login-8cc7a9cd.svg";const vt=o("img",{class:"auth-state__icon",src:ot,alt:"yes login"},null,-1),pt=o("img",{class:"auth-state__icon",src:gt,alt:"no login"},null,-1),Pt=[pt],de={__name:"authState",props:{player:String,backgroundColor:String},setup(t){ze(a=>({"8395b66e":t.backgroundColor}));const e=Z();return(a,n)=>(m(),h("div",null,[s(e).users[t.player]?(m(),D(s(qe),{key:0,to:"/userProfile?player="+t.player,class:W(["auth-state auth-state_cursor_pointer",{"auth-state_left":t.player==="P1","auth-state_right":t.player==="P2"}]),title:"Перейти на страницу профиля"},{default:Ze(()=>[vt]),_:1},8,["to","class"])):(m(),h("div",{key:1,class:W(["auth-state",{"auth-state_left":t.player==="P1","auth-state_right":t.player==="P2"}]),title:"Вход не выполнен"},Pt,2))]))}},_t="/darts-calculator/assets/login-7a8e4b4b.svg",St=(t,e,a)=>{if(localStorage.getItem(`user${t}`)){e.login(t,JSON.parse(localStorage.getItem(`user${t}`)));return}a("openAuthComp")},ht=(t,e)=>{rt(e.users[t].refreshToken),e.logout(t),localStorage.removeItem(`user${t}`)};const bt={__name:"loginAction",props:{player:String},emits:["openAuthComp"],setup(t){const e=Z();return(a,n)=>(m(),h("button",{class:W(["auth-action",{"auth-action_left":t.player==="P1","auth-action_right":t.player==="P2"}]),title:"вход/регистрация",onClick:n[0]||(n[0]=i=>s(St)(t.player,s(e),a.$emit))},[o("img",{class:W(["auth-action__icon",{"auth-action__icon_rotate_180deg":t.player==="P2"}]),src:_t,alt:"login"},null,2)],2))}},yt="/darts-calculator/assets/logout-9227746a.svg";const ft={__name:"logoutAction",props:{player:String},setup(t){const e=Z();return(a,n)=>(m(),h("button",{class:W(["auth-action",{"auth-action_left":t.player==="P1","auth-action_right":t.player==="P2"}]),title:"выход",onClick:n[0]||(n[0]=i=>s(ht)(t.player,s(e)))},[o("img",{class:W(["auth-action__icon",{"auth-action__icon_rotate_180deg":t.player==="P2"}]),src:yt,alt:"logout"},null,2)],2))}};const ge={__name:"authActions",props:{player:String,isSingle:Boolean},emits:["openAuthComp"],setup(t){const e=Z();return(a,n)=>s(e).users[t.player]?(m(),D(ft,{key:1,player:t.player,class:W({"auth-action_single-right":t.player==="P2"&&t.isSingle})},null,8,["player","class"])):(m(),D(bt,{key:0,class:W({"auth-action_single-right":t.player==="P2"&&t.isSingle}),player:t.player,onOpenAuthComp:n[0]||(n[0]=i=>a.$emit("openAuthComp"))},null,8,["class","player"]))}},$e=(t,e,a)=>{let n=Number(e.currentTarget.value);(e.data<"0"||e.data>"9")&&(n=1),a(`update:${t}`,n)},Ae=(t,e,a)=>{t.type==="change"?a("update:areSetsInGame",t.currentTarget.checked):a("update:areSetsInGame",!t.currentTarget.checked),It(t.currentTarget.previousElementSibling,e,a)},It=(t,e,a)=>{e&&a("update:setsToWin",1),e||setTimeout(()=>t.focus(),0)};const Gt=o("h3",{class:"game-setup__parameter-header"},"Необходимо для победы",-1),Lt={class:"game-setup__sets-legs sets-legs"},Dt={class:"sets-legs__parameter sets-legs__value_margin-right sets-legs__value_margin-left"},$t=["value","disabled"],At=["checked"],kt={class:"sets-legs__parameter"},Ct=["value"],wt={__name:"setsAndLegs",props:{setsToWin:Number,areSetsInGame:Boolean,legsToWin:Number},emits:["update:setsToWin","update:areSetsInGame","update:legsToWin"],setup(t){return(e,a)=>(m(),h(U,null,[Gt,o("div",Lt,[o("label",Dt,[ce(" Сетов "),o("input",{class:"sets-legs__value",type:"number",min:"1",value:t.setsToWin,onInput:a[0]||(a[0]=n=>s($e)("setsToWin",n,e.$emit)),onBlur:a[1]||(a[1]=n=>t.setsToWin?void 0:e.$emit("update:setsToWin",1)),disabled:!t.areSetsInGame},null,40,$t),o("input",{class:"sets-legs__is-disabled",type:"checkbox",checked:t.areSetsInGame,onChange:a[2]||(a[2]=n=>s(Ae)(n,t.areSetsInGame,e.$emit)),onKeyup:a[3]||(a[3]=O(n=>s(Ae)(n,t.areSetsInGame,e.$emit),["enter"]))},null,40,At)]),o("label",kt,[ce(" Легов "),o("input",{class:"sets-legs__value",type:"number",min:"1",value:t.legsToWin,onInput:a[4]||(a[4]=n=>s($e)("legsToWin",n,e.$emit)),onBlur:a[5]||(a[5]=n=>t.legsToWin?void 0:e.$emit("update:legsToWin",1))},null,40,Ct)])])],64))}};const Nt=o("h3",{class:"game-setup__parameter-header"},"Имена игроков",-1),Rt={class:"game-setup__player-names player-names"},Vt=["value","disabled"],Wt=["value","disabled"],Ft={__name:"playerNames",props:{nameP1:String,nameP2:String},emits:["update:nameP1","update:nameP2"],setup(t){const e=Z();return(a,n)=>{var i,c;return m(),h(U,null,[Nt,o("div",Rt,[o("input",{class:"player-names__name player-names__name_margin-right player-names__name_margin-bottom",type:"text",value:t.nameP1||((i=s(e).users.P1)==null?void 0:i.name),disabled:s(e).users.P1,onInput:n[0]||(n[0]=u=>a.$emit("update:nameP1",u.currentTarget.value)),maxlength:"15",required:"",onBlur:n[1]||(n[1]=u=>t.nameP1?void 0:a.$emit("update:nameP1","Игрок 1"))},null,40,Vt),o("input",{class:"player-names__name",type:"text",value:((c=s(e).users.P2)==null?void 0:c.name)||t.nameP2,disabled:s(e).users.P2,onInput:n[2]||(n[2]=u=>a.$emit("update:nameP2",u.currentTarget.value)),maxlength:"15",required:"",onBlur:n[3]||(n[3]=u=>t.nameP2?void 0:a.$emit("update:nameP2","Игрок 2"))},null,40,Wt)])],64)}}};const Tt={class:"game-setup__who-starts who-starts"},Ot=["checked"],Bt=o("h3",{class:"game-setup__parameter-header game-setup__parameter-header_margin_zero who-starts__header"}," Кто начинает ",-1),Et=["checked"],Mt={__name:"whoStarts",props:{whoStarts:String},emits:["update:whoStarts"],setup(t){return(e,a)=>(m(),h("div",Tt,[o("input",{class:"who-starts__radio-button",type:"radio",name:"whoStarts",value:"nameP1",checked:t.whoStarts==="nameP1",onChange:a[0]||(a[0]=n=>e.$emit("update:whoStarts","nameP1"))},null,40,Ot),Bt,o("input",{class:"who-starts__radio-button",type:"radio",name:"whoStarts",value:"nameP2",checked:t.whoStarts==="nameP2",onChange:a[1]||(a[1]=n=>e.$emit("update:whoStarts","nameP2"))},null,40,Et)]))}};const xt={class:"game-setup__is-percent-double is-percent-double"},Ht=["checked"],Ut=o("h3",{class:"game-setup__parameter-header game-setup__parameter-header_margin_zero is-percent-double__header"}," Подсчитывать процент удвоений ",-1),Jt=["checked"],Kt={__name:"isPercentDouble",props:{isPercentDoubleInStatP1:Boolean,isPercentDoubleInStatP2:Boolean},emits:["update:isPercentDoubleInStatP1","update:isPercentDoubleInStatP2"],setup(t){return(e,a)=>(m(),h("div",xt,[o("input",{class:"is-percent-double__value",type:"checkbox",checked:t.isPercentDoubleInStatP1,onChange:a[0]||(a[0]=n=>e.$emit("update:isPercentDoubleInStatP1",n.currentTarget.checked)),onKeyup:a[1]||(a[1]=O(n=>e.$emit("update:isPercentDoubleInStatP1",!n.currentTarget.checked),["enter"]))},null,40,Ht),Ut,o("input",{class:"is-percent-double__value",type:"checkbox",checked:t.isPercentDoubleInStatP2,onChange:a[2]||(a[2]=n=>e.$emit("update:isPercentDoubleInStatP2",n.currentTarget.checked)),onKeyup:a[3]||(a[3]=O(n=>e.$emit("update:isPercentDoubleInStatP2",!n.currentTarget.checked),["enter"]))},null,40,Jt)]))}},jt="/darts-calculator/assets/arrow_down-f9cd0121.svg",zt=t=>{const e=d(!1),a=()=>e.value=!0,n=()=>e.value=!1;return Te(t,n),document.addEventListener("click",n),Qe(()=>{document.removeEventListener("click",n)}),{seenSelectRemainders:e,showSelectRemainders:a,closeSelectRemainders:n}};const Zt=o("h3",{class:"game-setup__parameter-header"},"Формат матча",-1),qt=o("img",{class:"arrow-down-icon",src:jt,alt:"open"},null,-1),Qt={__name:"startRemainder",props:{startRemainder:Number},emits:["updateStartRemainder"],setup(t){const e=t,{seenSelectRemainders:a,showSelectRemainders:n,closeSelectRemainders:i}=zt(M(e,"startRemainder"));return(c,u)=>(m(),h(U,null,[Zt,o("div",{class:"game-setup__start-remainder start-remainder",onKeyup:u[8]||(u[8]=O((...r)=>s(i)&&s(i)(...r),["esc"]))},[o("div",{class:"start-remainder__header",tabindex:"0",onClick:u[0]||(u[0]=q((...r)=>s(n)&&s(n)(...r),["stop"])),onKeyup:u[1]||(u[1]=O((...r)=>s(n)&&s(n)(...r),["enter"])),autofocus:""},[ce(V(t.startRemainder)+" ",1),qt],32),J(o("div",{class:"start-remainder__values",onClick:u[7]||(u[7]=q(()=>{},["stop"]))},[o("div",{class:"start-remainder__value",tabindex:"0",onClick:u[2]||(u[2]=r=>t.startRemainder!==501?c.$emit("updateStartRemainder",501):s(i)()),onKeyup:u[3]||(u[3]=O(r=>t.startRemainder!==501?c.$emit("updateStartRemainder",501):s(i)(),["enter"]))}," 501 ",32),o("div",{class:"start-remainder__value",tabindex:"0",onClick:u[4]||(u[4]=r=>t.startRemainder!==1001?c.$emit("updateStartRemainder",1001):s(i)()),onKeyup:u[5]||(u[5]=O(r=>t.startRemainder!==1001?c.$emit("updateStartRemainder",1001):s(i)(),["enter"])),onKeydown:u[6]||(u[6]=O((...r)=>s(i)&&s(i)(...r),["tab"]))}," 1001 ",32)],512),[[K,s(a)]])],32)],64))}};const Xt={class:"dialog-content-wrapper"},Yt={class:"game-setup-wrapper"},ea={class:"game-setup"},ta={class:"auth-actions-wrapper"},aa=o("h2",{class:"game-setup__header"},"Настройка параметров матча",-1),sa={__name:"gameSetup",emits:["startGame"],setup(t,{emit:e}){const a=Y({loader:()=>ee(()=>import("./authComp-b13c5f84.js"),["assets/authComp-b13c5f84.js","assets/index-0d521d25.js","assets/index-46c032b2.css","assets/close-ed01941b.js","assets/loadingAuth-3286095e.js","assets/loadingAuth-dcf413b1.css","assets/authComp-cb950dcf.css"]),loadingComponent:Be,delay:0}),n=Z(),i=new mt(JSON.parse(localStorage.getItem("gameParameters"))),{visibility:c,showElement:u,hideElement:r}=ae(),{visibility:l,showElement:v,hideElement:L}=ae();return(T,g)=>(m(),h("div",Xt,[s(c)?(m(),D(s(a),{key:0,class:"game-setup__auth-comp_margin-top",onCloseAuthComp:s(r),player:"P1"},null,8,["onCloseAuthComp"])):I("",!0),s(l)?(m(),D(s(a),{key:1,class:"game-setup__auth-comp_margin-top",onCloseAuthComp:s(L),player:"P2"},null,8,["onCloseAuthComp"])):I("",!0),J(o("div",Yt,[G(de,{class:"game-setup__auth-state_top-left",player:"P1",backgroundColor:"rgb(177, 205, 223)"}),G(de,{class:"game-setup__auth-state_top-right",player:"P2",backgroundColor:"rgb(177, 205, 223)"}),o("div",ea,[o("div",ta,[G(ge,{player:"P1",onOpenAuthComp:s(u)},null,8,["onOpenAuthComp"]),G(ge,{player:"P2",onOpenAuthComp:s(v)},null,8,["onOpenAuthComp"])]),aa,G(Qt,{startRemainder:s(i).startRemainder.value,onUpdateStartRemainder:g[0]||(g[0]=b=>s(i).startRemainder.value=b)},null,8,["startRemainder"]),G(Ft,{nameP1:s(i).nameP1.value.value,"onUpdate:nameP1":g[1]||(g[1]=b=>s(i).nameP1.value.value=b),nameP2:s(i).nameP2.value.value,"onUpdate:nameP2":g[2]||(g[2]=b=>s(i).nameP2.value.value=b)},null,8,["nameP1","nameP2"]),G(Mt,{whoStarts:s(i).whoStarts.value,"onUpdate:whoStarts":g[3]||(g[3]=b=>s(i).whoStarts.value=b)},null,8,["whoStarts"]),G(Kt,{isPercentDoubleInStatP1:s(i).isPercentDoubleInStatP1.value,"onUpdate:isPercentDoubleInStatP1":g[4]||(g[4]=b=>s(i).isPercentDoubleInStatP1.value=b),isPercentDoubleInStatP2:s(i).isPercentDoubleInStatP2.value,"onUpdate:isPercentDoubleInStatP2":g[5]||(g[5]=b=>s(i).isPercentDoubleInStatP2.value=b)},null,8,["isPercentDoubleInStatP1","isPercentDoubleInStatP2"]),G(wt,{setsToWin:s(i).setsToWin.value,"onUpdate:setsToWin":g[6]||(g[6]=b=>s(i).setsToWin.value=b),areSetsInGame:s(i).areSetsInGame.value,"onUpdate:areSetsInGame":g[7]||(g[7]=b=>s(i).areSetsInGame.value=b),legsToWin:s(i).legsToWin.value,"onUpdate:legsToWin":g[8]||(g[8]=b=>s(i).legsToWin.value=b)},null,8,["setsToWin","areSetsInGame","legsToWin"]),o("button",{class:"base-button game-setup__start-game-button",onClick:g[9]||(g[9]=q(b=>s(ct)(s(i),s(n),s(dt),e),["prevent"]))}," Начать матч ")])],512),[[K,!s(c)&&!s(l)]])]))}},na=t=>{const e=d(t.value);return Te(t,()=>{e.value=t.value}),{roundPoints:e,checkNumber:(i,c)=>{(c.data<"0"||c.data>"9")&&(e.value=0),(e.value>180||e.value<0||e.value>i||i-e.value===1)&&(e.value=Math.trunc(e.value/10)),e.value===0&&(e.value="0",e.value=0)},setPoints:i=>{(e.value||e.value===0)&&i("setPoints",e.value)}}};const ke={__name:"roundPoints",props:{remainder:Number,points:Number,seenRoundPoints:Boolean},emits:["setPoints"],setup(t){const e=t,{roundPoints:a,checkNumber:n,setPoints:i}=na(M(e,"points"));return(c,u)=>J((m(),h("input",{class:"round-information__points",type:"number",min:"0",max:"180","onUpdate:modelValue":u[0]||(u[0]=r=>Oe(a)?a.value=r:null),onInput:u[1]||(u[1]=r=>s(n)(t.remainder,r)),onKeyup:u[2]||(u[2]=O(r=>s(i)(c.$emit),["enter"])),onFocus:u[3]||(u[3]=(...r)=>s(De)&&s(De)(...r))},null,544)),[[K,t.seenRoundPoints],[Xe,s(a)]])}},Ce=(t,e,a,n,i)=>{if(t==="P1")return P(()=>!!(e.value%2&&a.value%2&&n.value||e.value%2===0&&a.value%2&&i.value||e.value%2===0&&a.value%2===0&&n.value||e.value%2&&a.value%2===0&&i.value));if(t==="P2")return P(()=>!!(e.value%2===0&&a.value%2&&n.value||e.value%2&&a.value%2&&i.value||e.value%2&&a.value%2===0&&n.value||e.value%2===0&&a.value%2===0&&i.value))},we=(t,e,a,n,i)=>{let c=a-t;c>1&&i("setPointsAndRemainder",t,c,e,n),c===0&&i("legCompleted",e)};const ra={class:"points__round-information round-information"},ia={class:"round-information__points-area round-information__points-area_margin-right"},oa={class:"round-information__remainder"},la={class:"round-information__number-darts"},ua={class:"round-information__remainder"},ma={class:"round-information__points-area round-information__points-area_margin-left"},ca={__name:"roundInformation",props:{remainderBeforeGetPointsP1:Number,remainderBeforeGetPointsP2:Number,remainderAfterGetPointsP1:Number,remainderAfterGetPointsP2:Number,roundPointsP1:Number,roundPointsP2:Number,roundNumber:Number,legNumber:Number,setNumber:Number},emits:["setPointsAndRemainder","legCompleted"],setup(t){const e=t,a=Ce("P1",M(e,"legNumber"),M(e,"setNumber"),M(e,"remainderBeforeGetPointsP2"),M(e,"remainderAfterGetPointsP2")),n=Ce("P2",M(e,"legNumber"),M(e,"setNumber"),M(e,"remainderBeforeGetPointsP1"),M(e,"remainderAfterGetPointsP1"));return(i,c)=>(m(),h("div",ra,[o("div",ia,[G(ke,{remainder:t.remainderBeforeGetPointsP1,points:t.roundPointsP1,seenRoundPoints:s(a),onSetPoints:c[0]||(c[0]=u=>s(we)(u,"playerOne",t.remainderBeforeGetPointsP1,t.roundNumber,i.$emit))},null,8,["remainder","points","seenRoundPoints"])]),o("div",oa,V(t.remainderAfterGetPointsP1),1),o("div",la,V(t.roundNumber*3),1),o("div",ua,V(t.remainderAfterGetPointsP2),1),o("div",ma,[G(ke,{remainder:t.remainderBeforeGetPointsP2,points:t.roundPointsP2,seenRoundPoints:s(n),onSetPoints:c[1]||(c[1]=u=>s(we)(u,"playerTwo",t.remainderBeforeGetPointsP2,t.roundNumber,i.$emit))},null,8,["remainder","points","seenRoundPoints"])])]))}},da=()=>{const t=d([]);return{buttons:t,focusOnButton:a=>{var n;t.value[a.key]&&((n=t.value[a.key])==null?void 0:n.style.display)!=="none"&&t.value[a.key].focus()}}};const ga={class:"number-darts-dialog__message"},va={__name:"numberDartsModal",props:{seenZero:Boolean,seenOne:Boolean,seenThree:Boolean,message:String},setup(t){const e=t,a=d(null),{buttons:n,focusOnButton:i}=da();return(c,u)=>(m(),h("div",{class:"dialog-content-wrapper number-darts-dialog",onClick:u[0]||(u[0]=r=>a.value.focus()),onKeyup:u[1]||(u[1]=(...r)=>s(i)&&s(i)(...r))},[o("div",ga,V(e.message),1),o("div",{class:"number-darts-dialog__values",ref_key:"buttonsBox",ref:a,tabindex:"1"},[(m(),h(U,null,re(4,r=>J(o("button",{class:"number-darts-dialog__value",key:r+"darts",ref_for:!0,ref_key:"buttons",ref:n},V(r-1),1),[[K,r===1&&e.seenZero||r===2&&e.seenOne||r===3||r===4&&e.seenThree]])),64))],512)],32))}};const pa=o("div",{class:"leave-page-dialog__message"}," Вы собираетесь покинуть страницу начатого матча. Вы можете сохранить текущий прогресс и вернуться к матчу позже ",-1),Pa=o("button",{class:"leave-page-dialog__value"},"Сохранить матч",-1),_a=o("button",{class:"leave-page-dialog__value"},"Не сохранять",-1),Sa=o("button",{class:"leave-page-dialog__value"},"Отмена",-1),ha=[Pa,_a,Sa],ba={__name:"leavePageModal",setup(t){const e=d(null);return(a,n)=>(m(),h("div",{class:"dialog-content-wrapper leave-page-dialog",onClick:n[0]||(n[0]=i=>e.value.focus())},[pa,o("div",{class:"leave-page-dialog__values",ref_key:"buttonsBox",ref:e,tabindex:"1"},ha,512)]))}},ya="/darts-calculator/assets/menu-1c0dc877.svg";class ue{constructor(e,a,n){for(const i in n)this[i]=d(e&&n[i]);this.percentDouble||(this.percentDouble=d(e&&a)),n||(this.averagePoints=d(e),this.averageFirstNineDarts=d(e),this.averagePointsWinLegs=d(e),this.averagePointsLoseLegs=d(e),this.p180=d(e),this.p171=d(e),this.p131=d(e),this.p96=d(e),this.highestCheckout=d(e)),Object.defineProperty(this,"points",{value:P(()=>this.p180.value||this.p171.value||this.p131.value||this.p96.value),writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(this,"pointsGroup",{value:{p180:this.p180,p171:this.p171,p131:this.p131,p96:this.p96},writable:!0,enumerable:!1,configurable:!1})}unRef(){const e={};for(const a in this)e[a]=this[a].value;return e}selectAll(){for(const e in this)this[e].value=!0}removeSelection(){for(const e in this)this[e].value=!1}}class fa{constructor(e,a,n){this.averageFirstNineDarts=P(()=>e.averageFirstNineDarts.value||a.averageFirstNineDarts.value),this.averagePointsWinLegs=P(()=>e.averagePointsWinLegs.value||a.averagePointsWinLegs.value),this.averagePointsLoseLegs=P(()=>e.averagePointsLoseLegs.value||a.averagePointsLoseLegs.value),this.averagePoints=P(()=>e.averagePoints.value||a.averagePoints.value||n.value||this.averageFirstNineDarts.value||this.averagePointsWinLegs.value||this.averagePointsLoseLegs.value),this.points=P(()=>e.points.value||a.points.value),this.double=P(()=>e.percentDouble.value||a.percentDouble.value),this.highest=P(()=>e.highestCheckout.value||a.highestCheckout.value),this.closing=P(()=>this.double.value||this.highest.value)}}const Ia="/darts-calculator/assets/done-7dc2344c.svg",Ga="/darts-calculator/assets/remove_done-e5f536d8.svg",La={class:"statistic__values statistic-values"},Da={key:0,class:"statistic__value-header"},$a=["checked"],R={__name:"parameterVisibilitySetting",props:{parameterVisibility:Boolean,parameterGroup:String,seenParametersHeader:Boolean},emits:["update:parameterVisibility"],setup(t){return(e,a)=>(m(),h("label",La,[t.seenParametersHeader?(m(),h("h5",Da,V(t.parameterGroup)+V(t.parameterGroup==="171"||t.parameterGroup==="131"||t.parameterGroup==="96"?"+":void 0),1)):I("",!0),o("input",Ye({type:"checkbox",class:"statistic-values__visibility",checked:t.parameterVisibility,onChange:a[0]||(a[0]=n=>e.$emit("update:parameterVisibility",n.target))},e.$attrs),null,16,$a)]))}},Aa=(t,e)=>{t.target.type==="checkbox"&&e("update:parameterVisibility",t.target.dataset.groupName,t.target.dataset.parameterName,!t.target.checked)},ka=(t,e)=>{if(t.groupName==="leg"){e("update:seenAveragePointsLeg",t.checked);return}e("update:parameterVisibility",t.dataset.groupName,t.dataset.parameterName,t.checked)},Ne=(t,e,a,n,i)=>{localStorage.setItem(`seenParametersGame${t}`,JSON.stringify(e)),localStorage.setItem(`seenParametersSet${t}`,JSON.stringify(a)),localStorage.setItem(`seenAveragePointsLeg${t}`,JSON.stringify(n)),i("closeStatisticsVisibilitySettings")};const Ca=o("img",{class:"control-seen-elements__icon",src:Ia,alt:"выделить"},null,-1),wa=[Ca],Na=o("img",{class:"control-seen-elements__icon",src:Ga,alt:"снять"},null,-1),Ra=[Na],Va=o("img",{class:"statistic__icon",src:ut,alt:"закрыть"},null,-1),Wa=[Va],Fa={class:"statistic__average statistic-average"},Ta=o("h4",{class:"statistic__group-header statistic__group-header_margin-bottom"}," Средний набор ",-1),Oa={class:"statistic-average__points"},Ba={class:"statistic-average__nine-darts"},Ea=o("h5",{class:"statistic__parameter-header"},"9 дротиков",-1),Ma={class:"statistic-average__win-legs"},xa=o("h5",{class:"statistic__parameter-header"},"выигранные леги",-1),Ha={class:"statistic-average__lose-legs"},Ua=o("h5",{class:"statistic__parameter-header"},"проигранные леги",-1),Ja={class:"statistic__points statistic-points"},Ka=o("h4",{class:"statistic__group-header"},"Очки",-1),ja={class:"statistic-points__game-points"},za={key:0,class:"statistic__parameter-header"},Za={key:0,class:"statistic-points__set-points"},qa=o("h5",{class:"statistic__parameter-header"},"сет",-1),Qa={class:"statistic__closing statistic-closing"},Xa=o("h4",{class:"statistic__group-header"},"Закрытия",-1),Ya={key:0,class:"statistic-closing__double"},es=o("h5",{class:"statistic__parameter-header"},"% удвоений",-1),ts={class:"statistic-closing__highest"},as=o("h5",{class:"statistic__parameter-header"},"наибольшее",-1),ss={__name:"statisticsVisibilitySettings",props:{player:String,seenStatisticsVisisbilitySetting:Boolean,areSetsInGame:Boolean,isPercentDoubleInStat:Boolean,seenAveragePointsLeg:Boolean,seenParametersGame:Object,seenParametersSet:Object},emits:["closeStatisticsVisibilitySettings","selectAll","removeSelection","update:seenAveragePointsLeg","update:parameterVisibility"],setup(t,{emit:e}){const a=t,n=i=>ka(i,e);return(i,c)=>J((m(),h("div",{class:"statistic__player-statistic statistic__visibility",onKeyup:[c[3]||(c[3]=O(u=>s(Aa)(u,i.$emit),["enter"])),c[4]||(c[4]=O(u=>s(Ne)(t.player,t.seenParametersGame.unRef(),t.seenParametersSet.unRef(),t.seenAveragePointsLeg,i.$emit),["esc"]))]},[o("div",{class:W(["control-seen-elements",{"control-seen-elements_P1":a.player==="P1","control-seen-elements_P2":a.player==="P2"}])},[o("button",{class:"control-seen-elements__select-all",title:"Выделить все",onClick:c[0]||(c[0]=u=>i.$emit("selectAll"))},wa),o("button",{class:"control-seen-elements__select-all",title:"Снять выделение",onClick:c[1]||(c[1]=u=>i.$emit("removeSelection"))},Ra)],2),o("button",{class:W(["statistic__setup-visibility",{"statistic__setup-visibility_P1":a.player==="P1","statistic__setup-visibility_P2":a.player==="P2"}]),onClick:c[2]||(c[2]=u=>s(Ne)(t.player,t.seenParametersGame.unRef(),t.seenParametersSet.unRef(),t.seenAveragePointsLeg,i.$emit)),title:"Закрыть настройку видимости параметров"},Wa,2),o("div",Fa,[Ta,o("div",Oa,[G(R,{parameterGroup:"матч",parameterVisibility:a.seenParametersGame.averagePoints.value,"onUpdate:parameterVisibility":n,"data-group-name":"game","data-parameter-name":"averagePoints",areSetsInGame:a.areSetsInGame,seenParametersHeader:!0},null,8,["parameterVisibility","areSetsInGame"]),a.areSetsInGame?(m(),D(R,{key:0,parameterGroup:"сет",parameterVisibility:a.seenParametersSet.averagePoints.value,"onUpdate:parameterVisibility":n,"data-group-name":"set","data-parameter-name":"averagePoints",seenParametersHeader:a.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"])):I("",!0),G(R,{parameterGroup:"лег",parameterVisibility:t.seenAveragePointsLeg,"onUpdate:parameterVisibility":n,"data-group-name":"leg","data-parameter-name":"averagePoints",seenParametersHeader:!0},null,8,["parameterVisibility"])]),o("div",Ba,[Ea,G(R,{parameterGroup:"матч",parameterVisibility:a.seenParametersGame.averageFirstNineDarts.value,"onUpdate:parameterVisibility":n,"data-group-name":"game","data-parameter-name":"averageFirstNineDarts",seenParametersHeader:a.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"]),a.areSetsInGame?(m(),D(R,{key:0,parameterGroup:"сет",parameterVisibility:a.seenParametersSet.averageFirstNineDarts.value,"onUpdate:parameterVisibility":n,"data-group-name":"set","data-parameter-name":"averageFirstNineDarts",seenParametersHeader:a.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"])):I("",!0)]),o("div",Ma,[xa,G(R,{parameterGroup:"матч",parameterVisibility:a.seenParametersGame.averagePointsWinLegs.value,"onUpdate:parameterVisibility":n,"data-group-name":"game","data-parameter-name":"averagePointsWinLegs",seenParametersHeader:a.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"]),a.areSetsInGame?(m(),D(R,{key:0,parameterGroup:"сет",parameterVisibility:a.seenParametersSet.averagePointsWinLegs.value,"onUpdate:parameterVisibility":n,"data-group-name":"set","data-parameter-name":"averagePointsWinLegs",seenParametersHeader:a.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"])):I("",!0)]),o("div",Ha,[Ua,G(R,{parameterGroup:"матч",parameterVisibility:a.seenParametersGame.averagePointsLoseLegs.value,"onUpdate:parameterVisibility":n,"data-group-name":"game","data-parameter-name":"averagePointsLoseLegs",seenParametersHeader:a.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"]),a.areSetsInGame?(m(),D(R,{key:0,parameterGroup:"сет",parameterVisibility:a.seenParametersSet.averagePointsLoseLegs.value,"onUpdate:parameterVisibility":n,"data-group-name":"set","data-parameter-name":"averagePointsLoseLegs",seenParametersHeader:a.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"])):I("",!0)])]),o("div",Ja,[Ka,o("div",ja,[a.areSetsInGame?(m(),h("h5",za," матч ")):I("",!0),(m(!0),h(U,null,re(a.seenParametersGame.pointsGroup,(u,r)=>(m(),D(R,{key:r+"game",parameterGroup:r.slice(1),parameterVisibility:u.value,"onUpdate:parameterVisibility":n,"data-group-name":"game","data-parameter-name":r,seenParametersHeader:!0},null,8,["parameterGroup","parameterVisibility","data-parameter-name"]))),128))]),a.areSetsInGame?(m(),h("div",Za,[qa,(m(!0),h(U,null,re(a.seenParametersSet.pointsGroup,(u,r)=>(m(),D(R,{key:r+"set",parameterGroup:r.slice(1),parameterVisibility:u.value,"onUpdate:parameterVisibility":n,"data-group-name":"set","data-parameter-name":r,seenParametersHeader:a.areSetsInGame},null,8,["parameterGroup","parameterVisibility","data-parameter-name","seenParametersHeader"]))),128))])):I("",!0)]),o("div",Qa,[Xa,a.isPercentDoubleInStat?(m(),h("div",Ya,[es,G(R,{parameterGroup:"матч",parameterVisibility:a.seenParametersGame.percentDouble.value,"onUpdate:parameterVisibility":n,"data-group-name":"game","data-parameter-name":"percentDouble",seenParametersHeader:a.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"]),a.areSetsInGame?(m(),D(R,{key:0,parameterGroup:"сет",parameterVisibility:a.seenParametersSet.percentDouble.value,"onUpdate:parameterVisibility":n,"data-group-name":"set","data-parameter-name":"percentDouble",seenParametersHeader:a.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"])):I("",!0)])):I("",!0),o("div",ts,[as,G(R,{parameterGroup:"матч",parameterVisibility:a.seenParametersGame.highestCheckout.value,"onUpdate:parameterVisibility":n,"data-group-name":"game","data-parameter-name":"highestCheckout",seenParametersHeader:a.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"]),a.areSetsInGame?(m(),D(R,{key:0,parameterGroup:"сет",parameterVisibility:a.seenParametersSet.highestCheckout.value,"onUpdate:parameterVisibility":n,"data-group-name":"set","data-parameter-name":"highestCheckout",seenParametersHeader:a.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"])):I("",!0)])])],544)),[[K,t.seenStatisticsVisisbilitySetting]])}};const ns={class:"points-information__statistic statistic"},rs={class:"player-statistic-wrapper"},is={class:"statistic__player-statistic"},os=o("img",{class:"statistic__icon",src:ya,alt:"меню"},null,-1),ls=[os],Re={__name:"playerStatistic",props:{player:String,gameStatistic:Object,setStatistic:Object,averagePointsLeg:Number,areSetsInGame:Boolean,isPercentDoubleInStat:Boolean},setup(t){const e=t,a=Y({loader:()=>ee(()=>import("./authComp-b13c5f84.js"),["assets/authComp-b13c5f84.js","assets/index-0d521d25.js","assets/index-46c032b2.css","assets/close-ed01941b.js","assets/loadingAuth-3286095e.js","assets/loadingAuth-dcf413b1.css","assets/authComp-cb950dcf.css"]),loadingComponent:Be,delay:0}),n=Y({loader:()=>ee(()=>import("./statisticAverage-16626afa.js"),["assets/statisticAverage-16626afa.js","assets/index-0d521d25.js","assets/index-46c032b2.css"])}),i=Y({loader:()=>ee(()=>import("./statisticPoints-4deecbe3.js"),["assets/statisticPoints-4deecbe3.js","assets/index-0d521d25.js","assets/index-46c032b2.css"])}),c=Y({loader:()=>ee(()=>import("./statisticClosing-6128cc77.js"),["assets/statisticClosing-6128cc77.js","assets/index-0d521d25.js","assets/index-46c032b2.css"])}),{visibility:u,showElement:r,hideElement:l}=ae(),{visibility:v,showElement:L,hideElement:T}=ae(),{visibility:g,showElement:b,hideElement:x}=ae(!!(JSON.parse(localStorage.getItem(`seenAveragePointsLeg${e.player}`))??!0)),$=new ue(!0,e.isPercentDoubleInStat,JSON.parse(localStorage.getItem(`seenParametersGame${e.player}`))),y=e.areSetsInGame?new ue(!0,e.isPercentDoubleInStat,JSON.parse(localStorage.getItem(`seenParametersSet${e.player}`))):new ue(!1,e.isPercentDoubleInStat,JSON.parse(localStorage.getItem(`seenParametersSet${e.player}`))),C=new fa($,y,g),Q=()=>{$.selectAll(),e.areSetsInGame&&y.selectAll(),b()},f=()=>{$.removeSelection(),e.areSetsInGame&&y.removeSelection(),x()},S=(p,k,H)=>{p==="game"&&($[k].value=H),p==="set"&&(y[k].value=H),p==="leg"&&(g.value=H)};return(p,k)=>(m(),h("div",ns,[o("div",rs,[G(de,{backgroundColor:"rgb(182, 195, 197)",player:e.player,class:W({"player-statistic__auth-state_top-left":e.player==="P1","player-statistic__auth-state_top-right":e.player==="P2"})},null,8,["player","class"]),J(o("div",is,[G(ge,{player:t.player,isSingle:!0,onOpenAuthComp:s(r)},null,8,["player","onOpenAuthComp"]),o("button",{class:W(["statistic__setup-visibility",{"statistic__setup-visibility_P1":e.player==="P1","statistic__setup-visibility_P2":e.player==="P2"}]),onClick:k[0]||(k[0]=(...H)=>s(L)&&s(L)(...H)),title:"Настроить видимость параметров"},ls,2),s(C).averagePoints.value?(m(),D(s(n),{key:0,seenGroups:s(C),seenParametersGame:s($),seenParametersSet:s(y),seenAveragePointsLeg:s(g),gameStatistic:e.gameStatistic,setStatistic:e.setStatistic,averagePointsLeg:e.averagePointsLeg,areSetsInGame:e.areSetsInGame},null,8,["seenGroups","seenParametersGame","seenParametersSet","seenAveragePointsLeg","gameStatistic","setStatistic","averagePointsLeg","areSetsInGame"])):I("",!0),s(C).points.value?(m(),D(s(i),{key:1,seenParametersGame:s($),seenParametersSet:s(y),gameStatistic:e.gameStatistic,setStatistic:e.setStatistic,areSetsInGame:e.areSetsInGame},null,8,["seenParametersGame","seenParametersSet","gameStatistic","setStatistic","areSetsInGame"])):I("",!0),s(C).closing.value?(m(),D(s(c),{key:2,seenGroups:s(C),seenParametersGame:s($),seenParametersSet:s(y),gameStatistic:e.gameStatistic,setStatistic:e.setStatistic,areSetsInGame:e.areSetsInGame,isPercentDoubleInStat:e.isPercentDoubleInStat},null,8,["seenGroups","seenParametersGame","seenParametersSet","gameStatistic","setStatistic","areSetsInGame","isPercentDoubleInStat"])):I("",!0)],512),[[K,!s(v)&&!s(u)]]),G(ss,{player:e.player,seenStatisticsVisisbilitySetting:s(v),areSetsInGame:e.areSetsInGame,isPercentDoubleInStat:e.isPercentDoubleInStat,onCloseStatisticsVisibilitySettings:s(T),onSelectAll:Q,onRemoveSelection:f,seenParametersGame:s($),seenParametersSet:s(y),"onUpdate:parameterVisibility":S,seenAveragePointsLeg:s(g),"onUpdate:seenAveragePointsLeg":k[1]||(k[1]=H=>Oe(g)?g.value=H:null)},null,8,["player","seenStatisticsVisisbilitySetting","areSetsInGame","isPercentDoubleInStat","onCloseStatisticsVisibilitySettings","seenParametersGame","seenParametersSet","seenAveragePointsLeg"]),s(u)?(m(),D(s(a),{key:0,onCloseAuthComp:s(l),player:e.player},null,8,["onCloseAuthComp","player"])):I("",!0)])]))}};const us={class:"palyers-information__player-score player-score"},Ve={__name:"palyerScore",props:{setsWon:Number,legsWonInSet:Number,areSetsInGame:Boolean,player:String},setup(t){return(e,a)=>(m(),h("div",us,[o("div",{class:W(["player-score__legs-won",{"player-score__align_end":t.player==="P1"}])},V(t.player==="P1"?"Леги "+t.legsWonInSet:t.legsWonInSet+" Леги"),3),t.areSetsInGame?(m(),h("div",{key:0,class:W(["player-score__sets-won",{"player-score__align_end":t.player==="P1"}])},V(t.player==="P1"?"Сеты "+t.setsWon:t.setsWon+" Сеты"),3)):I("",!0)]))}},ms={},cs={class:"dialog-content-wrapper"};function ds(t,e){return m(),h("div",cs)}const gs=it(ms,[["render",ds]]),vs="/darts-calculator/assets/flag-b0bdae6b.svg";const ps={class:"starter-flag",src:vs,alt:"flag",title:"начинал лег"},We={__name:"starterFlag",props:{isSeen:Boolean},setup(t){return(e,a)=>J((m(),h("img",ps,null,512)),[[K,t.isSeen]])}},Ee=et("savedGame",()=>{const t=d(null);return{savedGame:t,setGame:n=>{t.value=n},resetGame:()=>t.value=null}}),Fe=(t,e)=>e%2?t%2?"P1":"P2":t%2?"P2":"P1",X=t=>{setTimeout(()=>{for(let e=t.length-1;e>=0;e--)if(t[e].style.display!=="none"&&!t[e].value){t[e].focus();return}})},me=async t=>{t.showModal();const a=await new Promise(n=>{t.children[0].addEventListener("click",function i(c){c.target.nodeName==="BUTTON"&&(t.children[0].removeEventListener("click",i),n(Number(c.target.innerHTML)))})});return t.close(),a},Ps=(t,e,a,n)=>{const i=t.legPoints.value[a-1]-e;t.legPoints.value[a-1]=e;for(let c=a-1;c<t.legRemainders.value.length;c++)t.legRemainders.value[c]+=i;t.pointsAndDartsLegs.value[n-1][0]-=i},_s=async(t,e)=>{t.showModal();const n=await new Promise(i=>{t.children[0].addEventListener("click",function c(u){u.target.nodeName==="BUTTON"&&(t.children[0].removeEventListener("click",c),u.target.textContent.trim()==="Сохранить матч"&&(Ee().setGame(e),i(!0)),u.target.textContent.trim()==="Не сохранять"&&i(!0),u.target.textContent.trim()==="Отмена"&&i(!1))})});return n||t.close(),n},Ss=()=>{const t=d(0),e=d(1),a=d(1),n=d([]),i=P(()=>n.value.reduce((u,r)=>u+r,0));class c{constructor(r,l){N(this,"legRemainders",d([]));N(this,"legPoints",d([]));N(this,"pointsAndDartsLegs",d([]));N(this,"dartsForDoubleSets",d([]));N(this,"p180Sets",d([]));N(this,"p171Sets",d([]));N(this,"p131Sets",d([]));N(this,"p96Sets",d([]));N(this,"averagePointsForFirstNineDartsLegs",d([]));N(this,"highestCheckoutSets",d([]));N(this,"setsWon",d(0));N(this,"legsWonInGame",P(()=>this.pointsAndDartsLegs.value.reduce((r,l)=>l[0]===501?r+1:r,0)));N(this,"legsWonInSet",P(()=>this.pointsAndDartsLegs.value.slice(i.value).reduce((r,l)=>l[0]===501?r+1:r,0)));N(this,"averagePointsLeg",P(()=>{var r,l;return Math.round((((r=this.pointsAndDartsLegs.value[e.value-1])==null?void 0:r[0])/((l=this.pointsAndDartsLegs.value[e.value-1])==null?void 0:l[1])*3||0)*100)/100}));N(this,"gameStatistic",{averagePoints:P(()=>Math.round((this.pointsAndDartsLegs.value.reduce((r,l)=>r+l[0],0)/this.pointsAndDartsLegs.value.reduce((r,l)=>r+l[1],0)*3||0)*100)/100),percentDouble:P(()=>Math.round((this.legsWonInGame.value/this.dartsForDoubleSets.value.reduce((r,l)=>r+l,0)*100||0)*100)/100),p180:P(()=>this.p180Sets.value.reduce((r,l)=>r+l,0)),p171:P(()=>this.p171Sets.value.reduce((r,l)=>r+l,0)),p131:P(()=>this.p131Sets.value.reduce((r,l)=>r+l,0)),p96:P(()=>this.p96Sets.value.reduce((r,l)=>r+l,0)),averageFirstNineDarts:P(()=>Math.round((this.averagePointsForFirstNineDartsLegs.value.reduce((r,l)=>r+l,0)/this.averagePointsForFirstNineDartsLegs.value.length||0)*100)/100),averagePointsWinLegs:P(()=>Math.round((this.legsWonInGame.value*501/this.pointsAndDartsLegs.value.reduce((r,l)=>l[0]===501?r+l[1]:r,0)*3||0)*100)/100),averagePointsLoseLegs:P(()=>{var r,l;return Math.round(((this.pointsAndDartsLegs.value.reduce((v,L)=>L[0]!==501?v+L[0]:v,0)-(((r=this.pointsAndDartsLegs.value[e.value-1])==null?void 0:r[0])||0))/(this.pointsAndDartsLegs.value.reduce((v,L)=>L[0]!==501?v+L[1]:v,0)-(((l=this.pointsAndDartsLegs.value[e.value-1])==null?void 0:l[1])||0))*3||0)*100)/100}),highestCheckout:P(()=>Math.max(...JSON.parse(JSON.stringify(this.highestCheckoutSets.value)),0))});N(this,"setStatistic",{averagePoints:P(()=>Math.round((this.pointsAndDartsLegs.value.slice(i.value).reduce((r,l)=>r+l[0],0)/this.pointsAndDartsLegs.value.slice(i.value).reduce((r,l)=>r+l[1],0)*3||0)*100)/100),percentDouble:P(()=>Math.round((this.legsWonInSet.value/this.dartsForDoubleSets.value[a.value-1]*100||0)*100)/100),p180:P(()=>this.p180Sets.value[a.value-1]||0),p171:P(()=>this.p171Sets.value[a.value-1]||0),p131:P(()=>this.p131Sets.value[a.value-1]||0),p96:P(()=>this.p96Sets.value[a.value-1]||0),averageFirstNineDarts:P(()=>Math.round((this.averagePointsForFirstNineDartsLegs.value.slice(i.value).reduce((r,l)=>r+l,0)/this.averagePointsForFirstNineDartsLegs.value.slice(i.value).length||0)*100)/100),averagePointsWinLegs:P(()=>Math.round((this.legsWonInSet.value*501/this.pointsAndDartsLegs.value.slice(i.value).reduce((r,l)=>l[0]===501?r+l[1]:r,0)*3||0)*100)/100),averagePointsLoseLegs:P(()=>{var r,l;return Math.round(((this.pointsAndDartsLegs.value.slice(i.value).reduce((v,L)=>L[0]!==501?v+L[0]:v,0)-(((r=this.pointsAndDartsLegs.value[e.value-1])==null?void 0:r[0])||0))/(this.pointsAndDartsLegs.value.slice(i.value).reduce((v,L)=>L[0]!==501?v+L[1]:v,0)-(((l=this.pointsAndDartsLegs.value[e.value-1])==null?void 0:l[1])||0))*3||0)*100)/100}),highestCheckout:P(()=>this.highestCheckoutSets.value[a.value-1]||0)});this.name=r,l&&(this.legRemainders.value=l.legRemainders,this.legPoints.value=l.legPoints,this.pointsAndDartsLegs.value=l.pointsAndDartsLegs,this.dartsForDoubleSets.value=l.dartsForDoubleSets,this.p180Sets.value=l.p180Sets,this.p171Sets.value=l.p171Sets,this.p131Sets.value=l.p131Sets,this.p96Sets.value=l.p96Sets,this.averagePointsForFirstNineDartsLegs.value=l.averagePointsForFirstNineDartsLegs,this.highestCheckoutSets.value=l.highestCheckoutSets,this.setsWon.value=l.setsWon),this.legStatForEndGame={dartsForDouble:0,p180:0,p171:0,p131:0,p96:0},Object.defineProperty(this.legStatForEndGame,"reset",{value:function(){for(const v in this)this[v]=0},writable:!1,enumerable:!1,configurable:!1})}clearPointsAndRemaindersLeg(){this.legRemainders.value=[],this.legPoints.value=[]}setInPointsAndDartsLegs(r,l,v){this.pointsAndDartsLegs.value[v-1]||(this.pointsAndDartsLegs.value[v-1]=[0,0]),this.pointsAndDartsLegs.value[v-1][0]+=r,this.pointsAndDartsLegs.value[v-1][1]+=l}checkAndSetHighPoints(r){var l,v,L,T,g,b,x,$;r===180&&((l=this.p180Sets.value)[v=a.value-1]??(l[v]=0),this.p180Sets.value[a.value-1]++,this.legStatForEndGame.p180++),r>=171&&r<180&&((L=this.p171Sets.value)[T=a.value-1]??(L[T]=0),this.p171Sets.value[a.value-1]++,this.legStatForEndGame.p171++),r>=131&&r<171&&((g=this.p131Sets.value)[b=a.value-1]??(g[b]=0),this.p131Sets.value[a.value-1]++,this.legStatForEndGame.p131++),r>=96&&r<131&&((x=this.p96Sets.value)[$=a.value-1]??(x[$]=0),this.p96Sets.value[a.value-1]++,this.legStatForEndGame.p96++)}checkAndSetHighestCheckout(){var r,l;(r=this.highestCheckoutSets.value)[l=a.value-1]??(r[l]=0),this.legRemainders.value.at(-1)>this.highestCheckoutSets.value[a.value-1]&&(this.highestCheckoutSets.value[a.value-1]=this.legRemainders.value.at(-1))}setAveragePointsForFirstNineDarts(){this.averagePointsForFirstNineDartsLegs.value[e.value-1]=Math.round(this.pointsAndDartsLegs.value[e.value-1][0]/this.pointsAndDartsLegs.value[e.value-1][1]*3*100)/100}calcStatWithoutLastLeg(r){return{averagePoints:{value:Math.round(((this.pointsAndDartsLegs.value.reduce((l,v)=>l+v[0],0)-this.pointsAndDartsLegs.value.at(-1)[0])/(this.pointsAndDartsLegs.value.reduce((l,v)=>l+v[1],0)-this.pointsAndDartsLegs.value.at(-1)[1])*3||0)*100)/100},percentDouble:{value:Math.round((this.legsWonInGame.value/(this.dartsForDoubleSets.value.reduce((l,v)=>l+v,0)-this.legStatForEndGame.dartsForDouble)*100||0)*100)/100},p180:{value:this.gameStatistic.p180.value-this.legStatForEndGame.p180},p171:{value:this.gameStatistic.p171.value-this.legStatForEndGame.p171},p131:{value:this.gameStatistic.p131.value-this.legStatForEndGame.p131},p96:{value:this.gameStatistic.p96.value-this.legStatForEndGame.p96},averageFirstNineDarts:{value:r>this.averagePointsForFirstNineDartsLegs.value.length?this.gameStatistic.averageFirstNineDarts.value:Math.round(((this.averagePointsForFirstNineDartsLegs.value.reduce((l,v)=>l+v,0)-this.averagePointsForFirstNineDartsLegs.value.at(-1))/(this.averagePointsForFirstNineDartsLegs.value.length-1)||0)*100)/100},averagePointsWinLegs:{value:this.gameStatistic.averagePointsWinLegs.value},averagePointsLoseLegs:{value:this.gameStatistic.averagePointsLoseLegs.value},highestCheckout:{value:this.gameStatistic.highestCheckout.value}}}}return{Player:c,startRemainder:t,legNumber:e,setNumber:a,legNumberInSets:n}};const hs={class:"page game-page game"},bs={class:"game__players-information players-information"},ys={class:"players-information__name players-information__name_position-left"},fs={class:"darts-icon-wrapper"},Is=["src"],Gs={class:"players-information__name players-information__name_position-right"},Ls={class:"game__points-information points-information"},Ds={class:"points-information__points points"},$s={class:"points__round-information round-information"},As=o("div",{class:"round-information__points-area round-information__points-area_margin-right"},null,-1),ks=o("div",{class:"round-information__number-darts"},null,-1),Cs=o("div",{class:"round-information__points-area round-information__points-area_margin-right"},null,-1),ws={__name:"GamePage",setup(t){const e=Y({loader:()=>ee(()=>import("./gameOver-5138833e.js"),["assets/gameOver-5138833e.js","assets/index-0d521d25.js","assets/index-46c032b2.css","assets/loadingAuth-3286095e.js","assets/loadingAuth-dcf413b1.css","assets/auth-2058c0d8.js","assets/fetch-5f5bc1cf.js","assets/yes_login-65e1999f.js","assets/yes_login-875e117f.css","assets/close-ed01941b.js","assets/gameOver-7f8ddbce.css"]),loadingComponent:gs,delay:0}),a=tt(),n=Z(),i=d(null),c=d(!1),u=d(!0),r=d(!0),l=d(""),v=d(null),L=d(null),T=d(!1),g=d(!1),b=d("P1");at(()=>{g.value||L.value.showModal()});const{Player:x,startRemainder:$,legNumber:y,setNumber:C,legNumberInSets:Q}=Ss();let f,S,p;const k=Ee();k.savedGame&&(f=k.savedGame.gameParameters,$.value=k.savedGame.startRemainder,S=new x(k.savedGame.playerOne.name,k.savedGame.playerOne),p=new x(k.savedGame.playerTwo.name,k.savedGame.playerTwo),y.value=k.savedGame.legNumber,C.value=k.savedGame.setNumber,Q.value=k.savedGame.legNumberInSets,k.resetGame(),g.value=!0,setTimeout(()=>X(document.forms[0]),0));const H=w=>{f=w,$.value=f.startRemainder,S=new x(f.nameP1),p=new x(f.nameP2),g.value=!0,L.value.close(),b.value=Fe(y.value,C.value),X(document.forms[0])},Me=async(w,_,B,E)=>{var j,z;const A=B==="playerOne"?S:p;if(E<=A.legRemainders.value.length){Ps(A,w,E,y.value),X(document.forms[0]);return}if((_<=50||w===0&&_<=170)&&(B==="playerOne"&&f.isPercentDoubleInStatP1||B==="playerTwo"&&f.isPercentDoubleInStatP2)){c.value=!0,l.value="Количество дротиков на удвоение";const te=await me(i.value);c.value=!1,(j=A.dartsForDoubleSets.value)[z=C.value-1]??(j[z]=0),A.dartsForDoubleSets.value[C.value-1]+=te,A.legStatForEndGame.dartsForDouble+=te}A.checkAndSetHighPoints(w),A.legPoints.value.push(w),A.legRemainders.value.push(_),A.setInPointsAndDartsLegs(w,3,y.value),A.pointsAndDartsLegs.value[y.value-1][1]===9&&A.setAveragePointsForFirstNineDarts(),X(document.forms[0])},xe=async w=>{var j,z;const _=w==="playerOne"?S:p,B=w==="playerOne"?p:S;let E;_.legRemainders.value.at(-1)>100&&_.legRemainders.value.at(-1)!==110&&(E=3),E||(l.value="Количество дротиков в подходе",_.legRemainders.value.at(-1)>40&&_.legRemainders.value.at(-1)!==50&&(u.value=!1),E=await me(i.value),u.value=!0);let A;if((w==="playerOne"&&f.isPercentDoubleInStatP1||w==="playerTwo"&&f.isPercentDoubleInStatP2)&&(_.legRemainders.value.at(-1)>100&&_.legRemainders.value.at(-1)!==110&&(A=1),A||(l.value="Количество дротиков на удвоение",_.legRemainders.value.at(-1)>40&&_.legRemainders.value.at(-1)!==50&&(r.value=!1),A=await me(i.value),r.value=!0)),_.setInPointsAndDartsLegs(_.legRemainders.value.at(-1),E,y.value),_.pointsAndDartsLegs.value[y.value-1][1]===9&&(_.setAveragePointsForFirstNineDarts(),B.pointsAndDartsLegs.value[y.value-1][1]===6&&B.setAveragePointsForFirstNineDarts()),(w==="playerOne"&&f.isPercentDoubleInStatP1||w==="playerTwo"&&f.isPercentDoubleInStatP2)&&((j=_.dartsForDoubleSets.value)[z=C.value-1]??(j[z]=0),_.dartsForDoubleSets.value[C.value-1]+=A,_.legStatForEndGame.dartsForDouble+=A),_.checkAndSetHighestCheckout(),_.checkAndSetHighPoints(_.legRemainders.value.at(-1)),_.legsWonInSet.value===f.legsToWin&&(Q.value.push(S.legsWonInSet.value+p.legsWonInSet.value),_.setsWon.value++,C.value++),S.clearPointsAndRemaindersLeg(),p.clearPointsAndRemaindersLeg(),_.setsWon.value===f.setsToWin){T.value=!0,v.value.showModal(),y.value++;return}S.legStatForEndGame.reset(),p.legStatForEndGame.reset(),y.value++,b.value=Fe(y.value,C.value),X(document.forms[0])};let ie={},oe={};const ne=d(!1),He=()=>{if(y.value===1){ve();return}ie=S.calcStatWithoutLastLeg(y.value),oe=p.calcStatWithoutLastLeg(y.value),ne.value=!0,T.value=!0,v.value.showModal()},ve=()=>{y.value=1,C.value=1,$.value=0,Q.value=[],v.value.close(),T.value=!1,g.value=!1,L.value.showModal(),S=void 0,p=void 0,ie={},oe={},ne.value=!1},Ue=st();let pe=!1;const Pe=d(null);return nt(w=>{const _=async()=>{await _s(Pe.value,{gameParameters:f,startRemainder:$,playerOne:S,playerTwo:p,legNumber:y,setNumber:C,legNumberInSets:Q})?(pe=!0,Ue.push(w.fullPath)):X(document.forms[0])};if((y.value>1||(S==null?void 0:S.legPoints.value[0])!==void 0||(p==null?void 0:p.legPoints.value[0])!==void 0)&&g.value&&!T.value&&!pe)return _(),!1}),(w,_)=>{var B,E,A,j,z,te,_e,Se,he,be,ye,fe,Ie,Ge;return m(),h(U,null,[o("dialog",{class:"dialog",ref_key:"gameSetupModal",ref:L,onCancel:_[0]||(_[0]=q(()=>{},["prevent"]))},[g.value?I("",!0):(m(),D(sa,{key:0,onStartGame:H}))],544),o("div",hs,[o("button",{class:"base-button game__end-button",onClick:He}," Завершить "),G(lt),o("header",bs,[o("div",ys,V(((B=s(n).users.P1)==null?void 0:B.name)||((E=s(S))==null?void 0:E.name)),1),G(We,{isSeen:b.value==="P1"},null,8,["isSeen"]),s(S)?(m(),D(Ve,{key:0,areSetsInGame:(A=s(f))==null?void 0:A.areSetsInGame,setsWon:(j=s(S))==null?void 0:j.setsWon.value,legsWonInSet:(z=s(S))==null?void 0:z.legsWonInSet.value,player:"P1"},null,8,["areSetsInGame","setsWon","legsWonInSet"])):I("",!0),o("div",fs,[s(a).svg.darts?(m(),h("img",{key:0,class:"darts-icon",src:s(a).svg.darts,alt:"darts"},null,8,Is)):I("",!0)]),s(p)?(m(),D(Ve,{key:1,areSetsInGame:(te=s(f))==null?void 0:te.areSetsInGame,setsWon:(_e=s(p))==null?void 0:_e.setsWon.value,legsWonInSet:(Se=s(p))==null?void 0:Se.legsWonInSet.value,player:"P2"},null,8,["areSetsInGame","setsWon","legsWonInSet"])):I("",!0),G(We,{isSeen:b.value==="P2"},null,8,["isSeen"]),o("div",Gs,V(((he=s(n).users.P2)==null?void 0:he.name)||((be=s(p))==null?void 0:be.name)),1)]),o("main",Ls,[s(S)?(m(),D(Re,{key:0,player:"P1",gameStatistic:s(S).gameStatistic,setStatistic:s(S).setStatistic,averagePointsLeg:s(S).averagePointsLeg.value,areSetsInGame:(ye=s(f))==null?void 0:ye.areSetsInGame,isPercentDoubleInStat:(fe=s(f))==null?void 0:fe.isPercentDoubleInStatP1},null,8,["gameStatistic","setStatistic","averagePointsLeg","areSetsInGame","isPercentDoubleInStat"])):I("",!0),o("form",Ds,[o("div",$s,[As,J(o("div",{class:"round-information__remainder"},V(s($)),513),[[K,g.value]]),ks,J(o("div",{class:"round-information__remainder"},V(s($)),513),[[K,g.value]]),Cs]),s(S)&&s(p)?(m(!0),h(U,{key:0},re(Math.max(s(S).legRemainders.value.length,s(p).legRemainders.value.length)+1,F=>(m(),h(U,{key:F+"line"},[(!(F-1)||s(S).legRemainders.value[F-2]&&s(p).legRemainders.value[F-2])&&g.value&&!T.value?(m(),D(ca,{key:0,remainderBeforeGetPointsP1:F-1?s(S).legRemainders.value[F-2]:s($),remainderBeforeGetPointsP2:F-1?s(p).legRemainders.value[F-2]:s($),remainderAfterGetPointsP1:s(S).legRemainders.value[F-1],remainderAfterGetPointsP2:s(p).legRemainders.value[F-1],roundPointsP1:s(S).legPoints.value[F-1],roundPointsP2:s(p).legPoints.value[F-1],roundNumber:F,legNumber:s(y),setNumber:s(C),onSetPointsAndRemainder:Me,onLegCompleted:xe},null,8,["remainderBeforeGetPointsP1","remainderBeforeGetPointsP2","remainderAfterGetPointsP1","remainderAfterGetPointsP2","roundPointsP1","roundPointsP2","roundNumber","legNumber","setNumber"])):I("",!0)],64))),128)):I("",!0)]),s(p)?(m(),D(Re,{key:1,player:"P2",gameStatistic:s(p).gameStatistic,setStatistic:s(p).setStatistic,averagePointsLeg:s(p).averagePointsLeg.value,areSetsInGame:(Ie=s(f))==null?void 0:Ie.areSetsInGame,isPercentDoubleInStat:(Ge=s(f))==null?void 0:Ge.isPercentDoubleInStatP2},null,8,["gameStatistic","setStatistic","averagePointsLeg","areSetsInGame","isPercentDoubleInStat"])):I("",!0)])]),o("dialog",{class:"dialog",ref_key:"numberDartsModal",ref:i,onCancel:_[1]||(_[1]=q(()=>{},["prevent"]))},[G(va,{message:l.value,seenZero:c.value,seenOne:u.value,seenThree:r.value},null,8,["message","seenZero","seenOne","seenThree"])],544),o("dialog",{class:"dialog",ref_key:"beforeLeavePage",ref:Pe,onCancel:_[2]||(_[2]=q(()=>{},["prevent"]))},[G(ba)],544),o("dialog",{class:"dialog",ref_key:"gameOverModal",ref:v,onCancel:_[3]||(_[3]=q(()=>{},["prevent"]))},[T.value?(m(),D(s(e),{key:0,onStartNewGame:ve,nameP1:s(S).name,nameP2:s(p).name,wonP1:s(f).areSetsInGame?s(S).setsWon.value:s(S).legsWonInGame.value,wonP2:s(f).areSetsInGame?s(p).setsWon.value:s(p).legsWonInGame.value,legsWonInGameP1:s(S).legsWonInGame.value,legsWonInGameP2:s(p).legsWonInGame.value,gameStatisticP1:ne.value?s(ie):s(S).gameStatistic,gameStatisticP2:ne.value?s(oe):s(p).gameStatistic,isPercentDoubleInStatP1:s(f).isPercentDoubleInStatP1,isPercentDoubleInStatP2:s(f).isPercentDoubleInStatP2,legNumber:s(y)-1},null,8,["nameP1","nameP2","wonP1","wonP2","legsWonInGameP1","legsWonInGameP2","gameStatisticP1","gameStatisticP2","isPercentDoubleInStatP1","isPercentDoubleInStatP2","legNumber"])):I("",!0)],544)],64)}}},Os=Object.freeze(Object.defineProperty({__proto__:null,default:ws},Symbol.toStringTag,{value:"Module"}));export{Os as G,Ia as _,de as a,ge as b};
