var ke=Object.defineProperty;var Ne=(a,t,e)=>t in a?ke(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var $=(a,t,e)=>(Ne(a,typeof t!="symbol"?t+"":t,e),e),we=(a,t,e)=>{if(!t.has(a))throw TypeError("Cannot "+e)};var te=(a,t,e)=>(we(a,t,"read from private field"),e?e.call(a):t.get(a)),Se=(a,t,e)=>{if(t.has(a))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(a):t.set(a,e)};import{k as j,c as p,r as c,u as Ce,o as d,b as h,a as r,i as D,j as Ve,n as V,R as We,d as o,e as ne,h as F,F as H,p as Re,q as z,t as C,w as K,v as J,s as Z,_ as q,m as b,l as G,x as Te,g as Be,f as ee,y as xe,z as Oe,A as Fe,B as Me,C as He,D as Ue}from"./index-5dc47f3f.js";import{d as Ee,L as Ie,_ as Ke}from"./fetch-7e6a8300.js";import{_ as Je,a as je}from"./homeButton-8b356e28.js";import{_ as ze}from"./close-ed01941b.js";var Q;class Ze{constructor(t){Se(this,Q,j());this.nameP1=p(()=>{var e;return((e=te(this,Q).users.P1)==null?void 0:e.name)||c((t==null?void 0:t.nameP1)||"Игрок 1")}),this.nameP2=p(()=>{var e;return((e=te(this,Q).users.P2)==null?void 0:e.name)||c((t==null?void 0:t.nameP2)||"Игрок 2")}),this.startRemainder=c((t==null?void 0:t.startRemainder)||501),this.whoStarts=c((t==null?void 0:t.whoStarts)||"nameP1"),this.legsToWin=c((t==null?void 0:t.legsToWin)||1),this.setsToWin=c((t==null?void 0:t.setsToWin)||1),this.areSetsInGame=c((t==null?void 0:t.areSetsInGame)||!1),this.isPercentDoubleInStatP1=c((t==null?void 0:t.isPercentDoubleInStatP1)||!1),this.isPercentDoubleInStatP2=c((t==null?void 0:t.isPercentDoubleInStatP2)||!1)}normalize(){const t={};for(const e in this)t[e]=this[e].value;if(t.nameP1.value&&(t.nameP1=t.nameP1.value),t.nameP2.value&&(t.nameP2=t.nameP2.value),t.whoStarts==="nameP2"){const e=t.isPercentDoubleInStatP1;t.isPercentDoubleInStatP1=t.isPercentDoubleInStatP2,t.isPercentDoubleInStatP2=e;const i=t.nameP1;t.nameP1=t.nameP2,t.nameP2=i}return t}}Q=new WeakMap;const qe=()=>{if(localStorage.getItem("userP1")&&localStorage.getItem("userP2")){const a=localStorage.getItem("userP1");localStorage.setItem("userP1",localStorage.getItem("userP2")),localStorage.setItem("userP2",a)}if(localStorage.getItem("userP1")&&!localStorage.getItem("userP2")?(localStorage.setItem("userP2",localStorage.getItem("userP1")),localStorage.removeItem("userP1")):!localStorage.getItem("userP1")&&localStorage.getItem("userP2")&&(localStorage.setItem("userP1",localStorage.getItem("userP2")),localStorage.removeItem("userP2")),localStorage.getItem("seenAveragePointsLegP2")&&localStorage.getItem("seenAveragePointsLegP1")){const a=localStorage.getItem("seenAveragePointsLegP1");localStorage.setItem("seenAveragePointsLegP1",localStorage.getItem("seenAveragePointsLegP2")),localStorage.setItem("seenAveragePointsLegP2",a)}if(localStorage.getItem("seenAveragePointsLegP1")&&!localStorage.getItem("seenAveragePointsLegP2")?(localStorage.setItem("seenAveragePointsLegP2",localStorage.getItem("seenAveragePointsLegP1")),localStorage.removeItem("seenAveragePointsLegP1")):!localStorage.getItem("seenAveragePointsLegP1")&&localStorage.getItem("seenAveragePointsLegP2")&&(localStorage.setItem("seenAveragePointsLegP1",localStorage.getItem("seenAveragePointsLegP2")),localStorage.removeItem("seenAveragePointsLegP2")),localStorage.getItem("seenParametersSetP2")&&localStorage.getItem("seenParametersSetP1")){const a=localStorage.getItem("seenParametersSetP1");localStorage.setItem("seenParametersSetP1",localStorage.getItem("seenParametersSetP2")),localStorage.setItem("seenParametersSetP2",a)}if(localStorage.getItem("seenParametersSetP1")&&!localStorage.getItem("seenParametersSetP2")?(localStorage.setItem("seenParametersSetP2",localStorage.getItem("seenParametersSetP1")),localStorage.removeItem("seenParametersSetP1")):!localStorage.getItem("seenParametersSetP1")&&localStorage.getItem("seenParametersSetP2")&&(localStorage.setItem("seenParametersSetP1",localStorage.getItem("seenParametersSetP2")),localStorage.removeItem("seenParametersSetP2")),localStorage.getItem("seenParametersGameP2")&&localStorage.getItem("seenParametersGameP1")){const a=localStorage.getItem("seenParametersGameP1");localStorage.setItem("seenParametersGameP1",localStorage.getItem("seenParametersGameP2")),localStorage.setItem("seenParametersGameP2",a)}localStorage.getItem("seenParametersGameP1")&&!localStorage.getItem("seenParametersGameP2")?(localStorage.setItem("seenParametersGameP2",localStorage.getItem("seenParametersGameP1")),localStorage.removeItem("seenParametersGameP1")):!localStorage.getItem("seenParametersGameP1")&&localStorage.getItem("seenParametersGameP2")&&(localStorage.setItem("seenParametersGameP1",localStorage.getItem("seenParametersGameP2")),localStorage.removeItem("seenParametersGameP2"))},Qe="/darts-calculator/assets/no_login-8cc7a9cd.svg";const Xe=o("img",{class:"auth-state__icon",src:Je,alt:"yes login"},null,-1),Ye=o("img",{class:"auth-state__icon",src:Qe,alt:"no login"},null,-1),et=[Ye],re={__name:"authState",props:{player:String,backgroundColor:String},setup(a){Ce(e=>({"03682086":a.backgroundColor}));const t=j();return(e,i)=>(d(),h("div",null,[r(t).users[a.player]?(d(),D(r(We),{key:0,to:"/userProfile?player="+a.player,class:V(["auth-state auth-state_cursor_pointer",{"auth-state_left":a.player==="P1","auth-state_right":a.player==="P2"}]),title:"Перейти на страницу профиля"},{default:Ve(()=>[Xe]),_:1},8,["to","class"])):(d(),h("div",{key:1,class:V(["auth-state",{"auth-state_left":a.player==="P1","auth-state_right":a.player==="P2"}]),title:"Вход не выполнен"},et,2))]))}},tt="/darts-calculator/assets/login-7a8e4b4b.svg";const at={__name:"loginAction",props:{player:String},emits:["openAuthComp"],setup(a,{emit:t}){const e=j(),i=m=>{if(localStorage.getItem(`user${m}`)){e.login(m,JSON.parse(localStorage.getItem(`user${m}`)));return}t("openAuthComp")};return(m,v)=>(d(),h("button",{class:V(["auth-action",{"auth-action_left":a.player==="P1","auth-action_right":a.player==="P2"}]),title:"вход/регистрация",onClick:v[0]||(v[0]=u=>i(a.player))},[o("img",{class:V(["auth-action__icon",{"auth-action__icon_rotate_180deg":a.player==="P2"}]),src:tt,alt:"login"},null,2)],2))}},st="/darts-calculator/assets/logout-9227746a.svg";const nt={__name:"logoutAction",props:{player:String},setup(a){const t=j(),e=i=>{Ee(t.users[i].refreshToken),t.logout(i),localStorage.removeItem(`user${i}`)};return(i,m)=>(d(),h("button",{class:V(["auth-action",{"auth-action_left":a.player==="P1","auth-action_right":a.player==="P2"}]),title:"выход",onClick:m[0]||(m[0]=v=>e(a.player))},[o("img",{class:V(["auth-action__icon",{"auth-action__icon_rotate_180deg":a.player==="P2"}]),src:st,alt:"logout"},null,2)],2))}};const ie={__name:"authActions",props:{player:String,isSingle:Boolean},emits:["openAuthComp"],setup(a){const t=j();return(e,i)=>r(t).users[a.player]?(d(),D(nt,{key:1,player:a.player,class:V({"auth-action_single-right":a.player==="P2"&&a.isSingle})},null,8,["player","class"])):(d(),D(at,{key:0,class:V({"auth-action_single-right":a.player==="P2"&&a.isSingle}),player:a.player,onOpenAuthComp:i[0]||(i[0]=m=>e.$emit("openAuthComp"))},null,8,["class","player"]))}};const rt=o("h3",{class:"game-setup__parameter-header"},"Необходимо для победы",-1),it={class:"game-setup__sets-legs sets-legs"},ot={class:"sets-legs__parameter sets-legs__value_margin-right sets-legs__value_margin-left"},lt=["value","disabled"],ut=["checked","onKeyup"],mt={class:"sets-legs__parameter"},ct=["value"],dt={__name:"setsAndLegs",props:{setsToWin:Number,areSetsInGame:Boolean,legsToWin:Number},emits:["update:setsToWin","update:areSetsInGame","update:legsToWin"],setup(a,{emit:t}){const e=a,i=(n,s)=>{let l=Number(s.currentTarget.value);(s.data<"0"||s.data>"9")&&(l=1),t(`update:${n}`,l)},m=(n,s)=>{e[n]||t(`update:${n}`,s)},v=n=>{n.type==="change"?t("update:areSetsInGame",n.currentTarget.checked):t("update:areSetsInGame",!n.currentTarget.checked),u(n.currentTarget.previousElementSibling)},u=n=>{e.areSetsInGame&&t("update:setsToWin",1),e.areSetsInGame||setTimeout(()=>n.focus(),0)};return(n,s)=>(d(),h(H,null,[rt,o("div",it,[o("label",ot,[ne(" Сетов "),o("input",{class:"sets-legs__value",type:"number",min:"1",value:a.setsToWin,onInput:s[0]||(s[0]=l=>i("setsToWin",l)),onBlur:s[1]||(s[1]=l=>m("setsToWin",1)),disabled:!a.areSetsInGame},null,40,lt),o("input",{class:"sets-legs__is-disabled",type:"checkbox",checked:a.areSetsInGame,onChange:v,onKeyup:F(v,["enter"])},null,40,ut)]),o("label",mt,[ne(" Легов "),o("input",{class:"sets-legs__value",type:"number",min:"1",value:a.legsToWin,onInput:s[2]||(s[2]=l=>i("legsToWin",l)),onBlur:s[3]||(s[3]=l=>m("legsToWin",1))},null,40,ct)])])],64))}};const gt=o("h3",{class:"game-setup__parameter-header"},"Имена игроков",-1),vt={class:"game-setup__player-names player-names"},pt=["value","disabled"],_t=["value","disabled"],Pt={__name:"playerNames",props:{nameP1:String,nameP2:String},emits:["update:nameP1","update:nameP2"],setup(a,{emit:t}){const e=a,i=j(),m=(v,u)=>{e[v]||t(`update:${v}`,u)};return(v,u)=>{var n,s;return d(),h(H,null,[gt,o("div",vt,[o("input",{class:"player-names__name player-names__name_margin-right player-names__name_margin-bottom",type:"text",value:a.nameP1||((n=r(i).users.P1)==null?void 0:n.name),disabled:r(i).users.P1,onInput:u[0]||(u[0]=l=>v.$emit("update:nameP1",l.currentTarget.value)),maxlength:"15",required:"",onBlur:u[1]||(u[1]=l=>m("nameP1","Игрок 1"))},null,40,pt),o("input",{class:"player-names__name",type:"text",value:((s=r(i).users.P2)==null?void 0:s.name)||a.nameP2,disabled:r(i).users.P2,onInput:u[2]||(u[2]=l=>v.$emit("update:nameP2",l.currentTarget.value)),maxlength:"15",required:"",onBlur:u[3]||(u[3]=l=>m("nameP2","Игрок 2"))},null,40,_t)])],64)}}};const St={class:"game-setup__who-starts who-starts"},ht=["checked"],bt=o("h3",{class:"game-setup__parameter-header game-setup__parameter-header_margin_zero who-starts__header"}," Кто начинает ",-1),yt=["checked"],ft={__name:"whoStarts",props:{whoStarts:String},emits:["update:whoStarts"],setup(a){return(t,e)=>(d(),h("div",St,[o("input",{class:"who-starts__radio-button",type:"radio",name:"whoStarts",value:"nameP1",checked:a.whoStarts==="nameP1",onChange:e[0]||(e[0]=i=>t.$emit("update:whoStarts","nameP1"))},null,40,ht),bt,o("input",{class:"who-starts__radio-button",type:"radio",name:"whoStarts",value:"nameP2",checked:a.whoStarts==="nameP2",onChange:e[1]||(e[1]=i=>t.$emit("update:whoStarts","nameP2"))},null,40,yt)]))}};const It={class:"game-setup__is-percent-double is-percent-double"},Gt=["checked"],Dt=o("h3",{class:"game-setup__parameter-header game-setup__parameter-header_margin_zero is-percent-double__header"}," Подсчитывать процент удвоений ",-1),Lt=["checked"],$t={__name:"isPercentDouble",props:{isPercentDoubleInStatP1:Boolean,isPercentDoubleInStatP2:Boolean},emits:["update:isPercentDoubleInStatP1","update:isPercentDoubleInStatP2"],setup(a){return(t,e)=>(d(),h("div",It,[o("input",{class:"is-percent-double__value",type:"checkbox",checked:a.isPercentDoubleInStatP1,onChange:e[0]||(e[0]=i=>t.$emit("update:isPercentDoubleInStatP1",i.currentTarget.checked)),onKeyup:e[1]||(e[1]=F(i=>t.$emit("update:isPercentDoubleInStatP1",!i.currentTarget.checked),["enter"]))},null,40,Gt),Dt,o("input",{class:"is-percent-double__value",type:"checkbox",checked:a.isPercentDoubleInStatP2,onChange:e[2]||(e[2]=i=>t.$emit("update:isPercentDoubleInStatP2",i.currentTarget.checked)),onKeyup:e[3]||(e[3]=F(i=>t.$emit("update:isPercentDoubleInStatP2",!i.currentTarget.checked),["enter"]))},null,40,Lt)]))}},At="/darts-calculator/assets/arrow_down-f9cd0121.svg";const kt=o("h3",{class:"game-setup__parameter-header"},"Формат матча",-1),Nt={class:"game-setup__start-remainder start-remainder"},wt=o("img",{class:"arrow-down-icon",src:At,alt:"open"},null,-1),Ct=["onKeydown"],Vt={__name:"startRemainder",props:{startRemainder:Number},emits:["updateStartRemainder"],setup(a,{emit:t}){const e=c(!1),i=v=>{t("updateStartRemainder",v),m()},m=()=>e.value=!1;return document.addEventListener("click",m),Re(()=>{document.removeEventListener("click",m)}),(v,u)=>(d(),h(H,null,[kt,o("div",Nt,[o("div",{class:"start-remainder__header",tabindex:"0",onClick:u[0]||(u[0]=z(n=>e.value=!0,["stop"])),onKeyup:u[1]||(u[1]=F(n=>e.value=!0,["enter"])),autofocus:""},[ne(C(a.startRemainder)+" ",1),wt],32),K(o("div",{class:"start-remainder__values",onClick:u[6]||(u[6]=z(()=>{},["stop"]))},[o("div",{class:"start-remainder__value",tabindex:"0",onClick:u[2]||(u[2]=n=>i(501)),onKeyup:u[3]||(u[3]=F(n=>i(501),["enter"]))}," 501 ",32),o("div",{class:"start-remainder__value",tabindex:"0",onClick:u[4]||(u[4]=n=>i(1001)),onKeyup:u[5]||(u[5]=F(n=>i(1001),["enter"])),onKeydown:F(m,["tab"])}," 1001 ",40,Ct)],512),[[J,e.value]])])],64))}};const Wt={class:"dialog-content-wrapper"},Rt={class:"game-setup-wrapper"},Tt={class:"game-setup"},Bt={class:"auth-actions-wrapper"},xt=o("h2",{class:"game-setup__header"},"Настройка параметров матча",-1),Ot={__name:"gameSetup",emits:["startGame"],setup(a,{emit:t}){const e=j(),i=new Ze(JSON.parse(localStorage.getItem("gameParameters"))),m=s=>{const l=s.normalize();l.whoStarts==="nameP2"&&(e.swap(),qe()),localStorage.setItem("gameParameters",JSON.stringify(l)),t("startGame",l)},v=c(!1),u=c(!1),n=Z({loader:()=>q(()=>import("./authComp-d7040a2c.js"),["assets/authComp-d7040a2c.js","assets/index-5dc47f3f.js","assets/index-196bc00e.css","assets/close-ed01941b.js","assets/fetch-7e6a8300.js","assets/fetch-5382e2d8.css","assets/authComp-11494628.css"]),loadingComponent:Ie,delay:0});return(s,l)=>(d(),h("div",Wt,[v.value?(d(),D(r(n),{key:0,class:"game-setup__auth-comp_margin-top",onCloseAuthComp:l[0]||(l[0]=g=>v.value=!1),player:"P1"})):b("",!0),u.value?(d(),D(r(n),{key:1,class:"game-setup__auth-comp_margin-top",onCloseAuthComp:l[1]||(l[1]=g=>u.value=!1),player:"P2"})):b("",!0),K(o("div",Rt,[G(re,{class:"game-setup__auth-state_top-left",player:"P1",backgroundColor:"rgb(177, 205, 223)"}),G(re,{class:"game-setup__auth-state_top-right",player:"P2",backgroundColor:"rgb(177, 205, 223)"}),o("div",Tt,[o("div",Bt,[G(ie,{player:"P1",onOpenAuthComp:l[2]||(l[2]=g=>v.value=!0)}),G(ie,{player:"P2",onOpenAuthComp:l[3]||(l[3]=g=>u.value=!0)})]),xt,G(Vt,{startRemainder:r(i).startRemainder.value,onUpdateStartRemainder:l[4]||(l[4]=g=>r(i).startRemainder.value=g)},null,8,["startRemainder"]),G(Pt,{nameP1:r(i).nameP1.value.value,"onUpdate:nameP1":l[5]||(l[5]=g=>r(i).nameP1.value.value=g),nameP2:r(i).nameP2.value.value,"onUpdate:nameP2":l[6]||(l[6]=g=>r(i).nameP2.value.value=g)},null,8,["nameP1","nameP2"]),G(ft,{whoStarts:r(i).whoStarts.value,"onUpdate:whoStarts":l[7]||(l[7]=g=>r(i).whoStarts.value=g)},null,8,["whoStarts"]),G($t,{isPercentDoubleInStatP1:r(i).isPercentDoubleInStatP1.value,"onUpdate:isPercentDoubleInStatP1":l[8]||(l[8]=g=>r(i).isPercentDoubleInStatP1.value=g),isPercentDoubleInStatP2:r(i).isPercentDoubleInStatP2.value,"onUpdate:isPercentDoubleInStatP2":l[9]||(l[9]=g=>r(i).isPercentDoubleInStatP2.value=g)},null,8,["isPercentDoubleInStatP1","isPercentDoubleInStatP2"]),G(dt,{setsToWin:r(i).setsToWin.value,"onUpdate:setsToWin":l[10]||(l[10]=g=>r(i).setsToWin.value=g),areSetsInGame:r(i).areSetsInGame.value,"onUpdate:areSetsInGame":l[11]||(l[11]=g=>r(i).areSetsInGame.value=g),legsToWin:r(i).legsToWin.value,"onUpdate:legsToWin":l[12]||(l[12]=g=>r(i).legsToWin.value=g)},null,8,["setsToWin","areSetsInGame","legsToWin"]),o("button",{class:"base-button game-setup__start-game-button",onClick:l[13]||(l[13]=z(g=>m(r(i)),["prevent"]))}," Начать матч ")])],512),[[J,!v.value&&!u.value]])]))}};const Ft=["onKeyup"],he={__name:"roundPoints",props:{remainder:Number,points:Number,seenRoundPoints:Boolean},emits:["setPoints"],setup(a,{emit:t}){const e=a,i=c(e.points);Te(()=>e.points,()=>{i.value=e.points});const m=u=>{(u.data<"0"||u.data>"9")&&(i.value=0),(i.value>180||i.value<0||i.value>e.remainder||e.remainder-i.value===1)&&(i.value=Math.trunc(i.value/10)),i.value===0&&(i.value="0",i.value=0)},v=()=>{(i.value||i.value===0)&&t("setPoints",i.value)};return(u,n)=>K((d(),h("input",{class:"round-information__points",type:"number",min:"0",max:"180","onUpdate:modelValue":n[0]||(n[0]=s=>i.value=s),onInput:m,onKeyup:F(v,["enter"])},null,40,Ft)),[[J,a.seenRoundPoints],[Be,i.value]])}};const Mt={class:"points__round-information round-information"},Ht={class:"round-information__points-area round-information__points-area_margin-right"},Ut={class:"round-information__remainder"},Et={class:"round-information__number-darts"},Kt={class:"round-information__remainder"},Jt={class:"round-information__points-area round-information__points-area_margin-left"},jt={__name:"roundInformation",props:{remainderBeforeGetPointsP1:Number,remainderBeforeGetPointsP2:Number,remainderAfterGetPointsP1:Number,remainderAfterGetPointsP2:Number,roundPointsP1:Number,roundPointsP2:Number,roundNumber:Number,legNumber:Number,setNumber:Number},emits:["setPointsAndRemainder","legCompleted"],setup(a,{emit:t}){const e=a,i=(u,n)=>{let l=e[`remainderBeforeGetPoints${n==="playerOne"?"P1":"P2"}`]-u;l>1&&t("setPointsAndRemainder",u,l,n,e.roundNumber),l===0&&t("legCompleted",n)},m=p(()=>Boolean(e.legNumber%2&&e.setNumber%2&&e.remainderBeforeGetPointsP2||e.legNumber%2===0&&e.setNumber%2&&e.remainderAfterGetPointsP2||e.legNumber%2===0&&e.setNumber%2===0&&e.remainderBeforeGetPointsP2||e.legNumber%2&&e.setNumber%2===0&&e.remainderAfterGetPointsP2)),v=p(()=>Boolean(e.legNumber%2===0&&e.setNumber%2&&e.remainderBeforeGetPointsP1||e.legNumber%2&&e.setNumber%2&&e.remainderAfterGetPointsP1||e.legNumber%2&&e.setNumber%2===0&&e.remainderBeforeGetPointsP1||e.legNumber%2===0&&e.setNumber%2===0&&e.remainderAfterGetPointsP1));return(u,n)=>(d(),h("div",Mt,[o("div",Ht,[G(he,{remainder:e.remainderBeforeGetPointsP1,points:e.roundPointsP1,seenRoundPoints:r(m),onSetPoints:n[0]||(n[0]=s=>i(s,"playerOne"))},null,8,["remainder","points","seenRoundPoints"])]),o("div",Ut,C(e.remainderAfterGetPointsP1),1),o("div",Et,C(e.roundNumber*3),1),o("div",Kt,C(e.remainderAfterGetPointsP2),1),o("div",Jt,[G(he,{remainder:e.remainderBeforeGetPointsP2,points:e.roundPointsP2,seenRoundPoints:r(v),onSetPoints:n[1]||(n[1]=s=>i(s,"playerTwo"))},null,8,["remainder","points","seenRoundPoints"])])]))}};const zt={class:"number-darts-dialog__message"},Zt={__name:"numberDartsModal",props:{seenZero:Boolean,seenOne:Boolean,seenThree:Boolean,message:String},setup(a){const t=a,e=c([]),i=c(null),m=u=>{var n;e.value[u.key]&&((n=e.value[u.key])==null?void 0:n.style.display)!=="none"&&e.value[u.key].focus()},v=()=>{i.value.focus()};return(u,n)=>(d(),h("div",{class:"dialog-content-wrapper number-darts-dialog",onClick:v,onKeyup:m},[o("div",zt,C(t.message),1),o("div",{class:"number-darts-dialog__values",ref_key:"buttonsBox",ref:i,tabindex:"1"},[(d(),h(H,null,ee(4,s=>K(o("button",{class:"number-darts-dialog__value",key:s+"darts",ref_for:!0,ref_key:"buttons",ref:e},C(s-1),1),[[J,s===1&&t.seenZero||s===2&&t.seenOne||s===3||s===4&&t.seenThree]])),64))],512)],32))}};const qt=o("div",{class:"leave-page-dialog__message"}," Вы собираетесь покинуть страницу начатого матча. Вы можете сохранить текущий прогресс и вернуться к матчу позже ",-1),Qt=o("button",{class:"leave-page-dialog__value"},"Сохранить матч",-1),Xt=o("button",{class:"leave-page-dialog__value"},"Не сохранять",-1),Yt=o("button",{class:"leave-page-dialog__value"},"Отмена",-1),ea=[Qt,Xt,Yt],ta={__name:"leavePageModal",setup(a){const t=c(null),e=()=>{t.value.focus()};return(i,m)=>(d(),h("div",{class:"dialog-content-wrapper leave-page-dialog",onClick:e},[qt,o("div",{class:"leave-page-dialog__values",ref_key:"buttonsBox",ref:t,tabindex:"1"},ea,512)]))}},aa="/darts-calculator/assets/menu-1c0dc877.svg";class ae{constructor(t,e,i){for(const m in i)this[m]=c(t&&i[m]);this.percentDouble||(this.percentDouble=c(t&&e)),i||(this.averagePoints=c(t),this.averageFirstNineDarts=c(t),this.averagePointsWinLegs=c(t),this.averagePointsLoseLegs=c(t),this.p180=c(t),this.p171=c(t),this.p131=c(t),this.p96=c(t),this.highestCheckout=c(t)),Object.defineProperty(this,"points",{value:p(()=>this.p180.value||this.p171.value||this.p131.value||this.p96.value),writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(this,"pointsGroup",{value:{p180:this.p180,p171:this.p171,p131:this.p131,p96:this.p96},writable:!0,enumerable:!1,configurable:!1})}unRef(){const t={};for(const e in this)t[e]=this[e].value;return t}selectAll(){for(const t in this)this[t].value=!0}removeSelection(){for(const t in this)this[t].value=!1}}class sa{constructor(t,e,i){this.averageFirstNineDarts=p(()=>t.averageFirstNineDarts.value||e.averageFirstNineDarts.value),this.averagePointsWinLegs=p(()=>t.averagePointsWinLegs.value||e.averagePointsWinLegs.value),this.averagePointsLoseLegs=p(()=>t.averagePointsLoseLegs.value||e.averagePointsLoseLegs.value),this.averagePoints=p(()=>t.averagePoints.value||e.averagePoints.value||i.value||this.averageFirstNineDarts.value||this.averagePointsWinLegs.value||this.averagePointsLoseLegs.value),this.points=p(()=>t.points.value||e.points.value),this.double=p(()=>t.percentDouble.value||e.percentDouble.value),this.highest=p(()=>t.highestCheckout.value||e.highestCheckout.value),this.closing=p(()=>this.double.value||this.highest.value)}}const na="/darts-calculator/assets/done-7dc2344c.svg",ra="/darts-calculator/assets/remove_done-e5f536d8.svg",ia={class:"statistic__values statistic-values"},oa={key:0,class:"statistic__value-header"},la=["checked"],k={__name:"parameterVisibilitySetting",props:{parameterVisibility:Boolean,parameterGroup:String,seenParametersHeader:Boolean},emits:["update:parameterVisibility"],setup(a){return(t,e)=>(d(),h("label",ia,[a.seenParametersHeader?(d(),h("h5",oa,C(a.parameterGroup)+C(a.parameterGroup==="171"||a.parameterGroup==="131"||a.parameterGroup==="96"?"+":void 0),1)):b("",!0),o("input",xe({type:"checkbox",class:"statistic-values__visibility",checked:a.parameterVisibility,onChange:e[0]||(e[0]=i=>t.$emit("update:parameterVisibility",i.target))},t.$attrs),null,16,la)]))}};const ua=["onKeyup"],ma=o("img",{class:"control-seen-elements__icon",src:na,alt:"выделить"},null,-1),ca=[ma],da=o("img",{class:"control-seen-elements__icon",src:ra,alt:"снять"},null,-1),ga=[da],va=o("img",{class:"statistic__icon",src:ze,alt:"закрыть"},null,-1),pa=[va],_a={class:"statistic__average statistic-average"},Pa=o("h4",{class:"statistic__group-header statistic__group-header_margin-bottom"}," Средний набор ",-1),Sa={class:"statistic-average__points"},ha={class:"statistic-average__nine-darts"},ba=o("h5",{class:"statistic__parameter-header"},"9 дротиков",-1),ya={class:"statistic-average__win-legs"},fa=o("h5",{class:"statistic__parameter-header"},"выигранные леги",-1),Ia={class:"statistic-average__lose-legs"},Ga=o("h5",{class:"statistic__parameter-header"},"проигранные леги",-1),Da={class:"statistic__points statistic-points"},La=o("h4",{class:"statistic__group-header"},"Очки",-1),$a={class:"statistic-points__game-points"},Aa={key:0,class:"statistic__parameter-header"},ka={key:0,class:"statistic-points__set-points"},Na=o("h5",{class:"statistic__parameter-header"},"сет",-1),wa={class:"statistic__closing statistic-closing"},Ca=o("h4",{class:"statistic__group-header"},"Закрытия",-1),Va={key:0,class:"statistic-closing__double"},Wa=o("h5",{class:"statistic__parameter-header"},"% удвоений",-1),Ra={class:"statistic-closing__highest"},Ta=o("h5",{class:"statistic__parameter-header"},"наибольшее",-1),Ba={__name:"statisticsVisibilitySettings",props:{player:String,seenStatisticsVisisbilitySetting:Boolean,areSetsInGame:Boolean,isPercentDoubleInStat:Boolean,seenAveragePointsLeg:Boolean,seenParametersGame:Object,seenParametersSet:Object},emits:["closeStatisticsVisibilitySettings","selectAll","removeSelection","update:seenAveragePointsLeg","update:parameterVisibility"],setup(a,{emit:t}){const e=a,i=u=>{u.target.type==="checkbox"&&t("update:parameterVisibility",u.target.dataset.groupName,u.target.dataset.parameterName,!u.target.checked)},m=u=>{if(u.groupName==="leg"){t("update:seenAveragePointsLeg",u.checked);return}t("update:parameterVisibility",u.dataset.groupName,u.dataset.parameterName,u.checked)},v=()=>{localStorage.setItem(`seenParametersGame${e.player}`,JSON.stringify(e.seenParametersGame.unRef())),localStorage.setItem(`seenParametersSet${e.player}`,JSON.stringify(e.seenParametersSet.unRef())),localStorage.setItem(`seenAveragePointsLeg${e.player}`,JSON.stringify(e.seenAveragePointsLeg)),t("closeStatisticsVisibilitySettings")};return(u,n)=>K((d(),h("div",{class:"statistic__player-statistic statistic__visibility",onKeyup:[F(i,["enter"]),F(v,["esc"])]},[o("div",{class:V(["control-seen-elements",{"control-seen-elements_P1":e.player==="P1","control-seen-elements_P2":e.player==="P2"}])},[o("button",{class:"control-seen-elements__select-all",title:"Выделить все",onClick:n[0]||(n[0]=s=>u.$emit("selectAll"))},ca),o("button",{class:"control-seen-elements__select-all",title:"Снять выделение",onClick:n[1]||(n[1]=s=>u.$emit("removeSelection"))},ga)],2),o("button",{class:V(["statistic__setup-visibility",{"statistic__setup-visibility_P1":e.player==="P1","statistic__setup-visibility_P2":e.player==="P2"}]),onClick:v,title:"Закрыть настройку видимости параметров"},pa,2),o("div",_a,[Pa,o("div",Sa,[G(k,{parameterGroup:"матч",parameterVisibility:e.seenParametersGame.averagePoints.value,"onUpdate:parameterVisibility":m,"data-group-name":"game","data-parameter-name":"averagePoints",areSetsInGame:e.areSetsInGame,seenParametersHeader:!0},null,8,["parameterVisibility","areSetsInGame"]),e.areSetsInGame?(d(),D(k,{key:0,parameterGroup:"сет",parameterVisibility:e.seenParametersSet.averagePoints.value,"onUpdate:parameterVisibility":m,"data-group-name":"set","data-parameter-name":"averagePoints",seenParametersHeader:e.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"])):b("",!0),G(k,{parameterGroup:"лег",parameterVisibility:a.seenAveragePointsLeg,"onUpdate:parameterVisibility":m,"data-group-name":"leg","data-parameter-name":"averagePoints",seenParametersHeader:!0},null,8,["parameterVisibility"])]),o("div",ha,[ba,G(k,{parameterGroup:"матч",parameterVisibility:e.seenParametersGame.averageFirstNineDarts.value,"onUpdate:parameterVisibility":m,"data-group-name":"game","data-parameter-name":"averageFirstNineDarts",seenParametersHeader:e.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"]),e.areSetsInGame?(d(),D(k,{key:0,parameterGroup:"сет",parameterVisibility:e.seenParametersSet.averageFirstNineDarts.value,"onUpdate:parameterVisibility":m,"data-group-name":"set","data-parameter-name":"averageFirstNineDarts",seenParametersHeader:e.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"])):b("",!0)]),o("div",ya,[fa,G(k,{parameterGroup:"матч",parameterVisibility:e.seenParametersGame.averagePointsWinLegs.value,"onUpdate:parameterVisibility":m,"data-group-name":"game","data-parameter-name":"averagePointsWinLegs",seenParametersHeader:e.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"]),e.areSetsInGame?(d(),D(k,{key:0,parameterGroup:"сет",parameterVisibility:e.seenParametersSet.averagePointsWinLegs.value,"onUpdate:parameterVisibility":m,"data-group-name":"set","data-parameter-name":"averagePointsWinLegs",seenParametersHeader:e.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"])):b("",!0)]),o("div",Ia,[Ga,G(k,{parameterGroup:"матч",parameterVisibility:e.seenParametersGame.averagePointsLoseLegs.value,"onUpdate:parameterVisibility":m,"data-group-name":"game","data-parameter-name":"averagePointsLoseLegs",seenParametersHeader:e.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"]),e.areSetsInGame?(d(),D(k,{key:0,parameterGroup:"сет",parameterVisibility:e.seenParametersSet.averagePointsLoseLegs.value,"onUpdate:parameterVisibility":m,"data-group-name":"set","data-parameter-name":"averagePointsLoseLegs",seenParametersHeader:e.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"])):b("",!0)])]),o("div",Da,[La,o("div",$a,[e.areSetsInGame?(d(),h("h5",Aa," матч ")):b("",!0),(d(!0),h(H,null,ee(e.seenParametersGame.pointsGroup,(s,l)=>(d(),D(k,{key:l+"game",parameterGroup:l.slice(1),parameterVisibility:s.value,"onUpdate:parameterVisibility":m,"data-group-name":"game","data-parameter-name":l,seenParametersHeader:!0},null,8,["parameterGroup","parameterVisibility","data-parameter-name"]))),128))]),e.areSetsInGame?(d(),h("div",ka,[Na,(d(!0),h(H,null,ee(e.seenParametersSet.pointsGroup,(s,l)=>(d(),D(k,{key:l+"set",parameterGroup:l.slice(1),parameterVisibility:s.value,"onUpdate:parameterVisibility":m,"data-group-name":"set","data-parameter-name":l,seenParametersHeader:e.areSetsInGame},null,8,["parameterGroup","parameterVisibility","data-parameter-name","seenParametersHeader"]))),128))])):b("",!0)]),o("div",wa,[Ca,e.isPercentDoubleInStat?(d(),h("div",Va,[Wa,G(k,{parameterGroup:"матч",parameterVisibility:e.seenParametersGame.percentDouble.value,"onUpdate:parameterVisibility":m,"data-group-name":"game","data-parameter-name":"percentDouble",seenParametersHeader:e.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"]),e.areSetsInGame?(d(),D(k,{key:0,parameterGroup:"сет",parameterVisibility:e.seenParametersSet.percentDouble.value,"onUpdate:parameterVisibility":m,"data-group-name":"set","data-parameter-name":"percentDouble",seenParametersHeader:e.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"])):b("",!0)])):b("",!0),o("div",Ra,[Ta,G(k,{parameterGroup:"матч",parameterVisibility:e.seenParametersGame.highestCheckout.value,"onUpdate:parameterVisibility":m,"data-group-name":"game","data-parameter-name":"highestCheckout",seenParametersHeader:e.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"]),e.areSetsInGame?(d(),D(k,{key:0,parameterGroup:"сет",parameterVisibility:e.seenParametersSet.highestCheckout.value,"onUpdate:parameterVisibility":m,"data-group-name":"set","data-parameter-name":"highestCheckout",seenParametersHeader:e.areSetsInGame},null,8,["parameterVisibility","seenParametersHeader"])):b("",!0)])])],40,ua)),[[J,a.seenStatisticsVisisbilitySetting]])}};const xa={class:"points-information__statistic statistic"},Oa={class:"player-statistic-wrapper"},Fa={class:"statistic__player-statistic"},Ma=o("img",{class:"statistic__icon",src:aa,alt:"меню"},null,-1),Ha=[Ma],be={__name:"playerStatistic",props:{player:String,gameStatistic:Object,setStatistic:Object,averagePointsLeg:Number,areSetsInGame:Boolean,isPercentDoubleInStat:Boolean},setup(a){const t=a,e=Z({loader:()=>q(()=>import("./authComp-d7040a2c.js"),["assets/authComp-d7040a2c.js","assets/index-5dc47f3f.js","assets/index-196bc00e.css","assets/close-ed01941b.js","assets/fetch-7e6a8300.js","assets/fetch-5382e2d8.css","assets/authComp-11494628.css"]),loadingComponent:Ie,delay:0}),i=Z({loader:()=>q(()=>import("./statisticAverage-e8a64510.js"),["assets/statisticAverage-e8a64510.js","assets/index-5dc47f3f.js","assets/index-196bc00e.css"])}),m=Z({loader:()=>q(()=>import("./statisticPoints-b5c4c72e.js"),["assets/statisticPoints-b5c4c72e.js","assets/index-5dc47f3f.js","assets/index-196bc00e.css"])}),v=Z({loader:()=>q(()=>import("./statisticClosing-53e9b797.js"),["assets/statisticClosing-53e9b797.js","assets/index-5dc47f3f.js","assets/index-196bc00e.css"])}),u=c(!1),n=c(!1),s=c(Boolean(JSON.parse(localStorage.getItem(`seenAveragePointsLeg${t.player}`))??!0)),l=new ae(!0,t.isPercentDoubleInStat,JSON.parse(localStorage.getItem(`seenParametersGame${t.player}`))),g=t.areSetsInGame?new ae(!0,t.isPercentDoubleInStat,JSON.parse(localStorage.getItem(`seenParametersSet${t.player}`))):new ae(!1,t.isPercentDoubleInStat,JSON.parse(localStorage.getItem(`seenParametersSet${t.player}`))),N=new sa(l,g,s),W=()=>{l.selectAll(),t.areSetsInGame&&g.selectAll(),s.value=!0},M=()=>{l.removeSelection(),t.areSetsInGame&&g.removeSelection(),s.value=!1},R=(f,y,w)=>{f==="game"&&(l[y].value=w),f==="set"&&(g[y].value=w),f==="leg"&&(s.value=w)};return(f,y)=>(d(),h("div",xa,[o("div",Oa,[G(re,{backgroundColor:"rgb(182, 195, 197)",player:t.player,class:V({"player-statistic__auth-state_top-left":t.player==="P1","player-statistic__auth-state_top-right":t.player==="P2"})},null,8,["player","class"]),K(o("div",Fa,[G(ie,{player:a.player,isSingle:!0,onOpenAuthComp:y[0]||(y[0]=w=>u.value=!0)},null,8,["player"]),o("button",{class:V(["statistic__setup-visibility",{"statistic__setup-visibility_P1":t.player==="P1","statistic__setup-visibility_P2":t.player==="P2"}]),onClick:y[1]||(y[1]=w=>n.value=!0),title:"Настроить видимость параметров"},Ha,2),r(N).averagePoints.value?(d(),D(r(i),{key:0,seenGroups:r(N),seenParametersGame:r(l),seenParametersSet:r(g),seenAveragePointsLeg:s.value,gameStatistic:t.gameStatistic,setStatistic:t.setStatistic,averagePointsLeg:t.averagePointsLeg,areSetsInGame:t.areSetsInGame},null,8,["seenGroups","seenParametersGame","seenParametersSet","seenAveragePointsLeg","gameStatistic","setStatistic","averagePointsLeg","areSetsInGame"])):b("",!0),r(N).points.value?(d(),D(r(m),{key:1,seenParametersGame:r(l),seenParametersSet:r(g),gameStatistic:t.gameStatistic,setStatistic:t.setStatistic,areSetsInGame:t.areSetsInGame},null,8,["seenParametersGame","seenParametersSet","gameStatistic","setStatistic","areSetsInGame"])):b("",!0),r(N).closing.value?(d(),D(r(v),{key:2,seenGroups:r(N),seenParametersGame:r(l),seenParametersSet:r(g),gameStatistic:t.gameStatistic,setStatistic:t.setStatistic,areSetsInGame:t.areSetsInGame,isPercentDoubleInStat:t.isPercentDoubleInStat},null,8,["seenGroups","seenParametersGame","seenParametersSet","gameStatistic","setStatistic","areSetsInGame","isPercentDoubleInStat"])):b("",!0)],512),[[J,!n.value&&!u.value]]),G(Ba,{player:t.player,seenStatisticsVisisbilitySetting:n.value,areSetsInGame:t.areSetsInGame,isPercentDoubleInStat:t.isPercentDoubleInStat,onCloseStatisticsVisibilitySettings:y[2]||(y[2]=w=>n.value=!1),onSelectAll:W,onRemoveSelection:M,seenParametersGame:r(l),seenParametersSet:r(g),"onUpdate:parameterVisibility":R,seenAveragePointsLeg:s.value,"onUpdate:seenAveragePointsLeg":y[3]||(y[3]=w=>s.value=w)},null,8,["player","seenStatisticsVisisbilitySetting","areSetsInGame","isPercentDoubleInStat","seenParametersGame","seenParametersSet","seenAveragePointsLeg"]),u.value?(d(),D(r(e),{key:0,onCloseAuthComp:y[4]||(y[4]=w=>u.value=!1),player:t.player},null,8,["player"])):b("",!0)])]))}};const Ua={class:"palyers-information__player-score player-score"},ye={__name:"palyerScore",props:{setsWon:Number,legsWonInSet:Number,areSetsInGame:Boolean,player:String},setup(a){return(t,e)=>(d(),h("div",Ua,[o("div",{class:V(["player-score__legs-won",{"player-score__align_end":a.player==="P1"}])},C(a.player==="P1"?"Леги "+a.legsWonInSet:a.legsWonInSet+" Леги"),3),a.areSetsInGame?(d(),h("div",{key:0,class:V(["player-score__sets-won",{"player-score__align_end":a.player==="P1"}])},C(a.player==="P1"?"Сеты "+a.setsWon:a.setsWon+" Сеты"),3)):b("",!0)]))}},Ea={},Ka={class:"dialog-content-wrapper"};function Ja(a,t){return d(),h("div",Ka)}const ja=Ke(Ea,[["render",Ja]]),Ge=Oe("savedGame",()=>{const a=c(null);return{savedGame:a,setGame:i=>{a.value=i},resetGame:()=>a.value=null}}),fe=(a,t,e)=>{t%2?a%2?setTimeout(()=>e[e.length-2].focus(),0):setTimeout(()=>e[e.length-1].focus(),0):a%2?setTimeout(()=>e[e.length-1].focus(),0):setTimeout(()=>e[e.length-2].focus(),0)},Y=(a,t)=>{a==="playerOne"&&setTimeout(()=>t[t.length-1].focus(),0),a==="playerTwo"&&setTimeout(()=>t[t.length-2].focus(),0)},se=async a=>{a.showModal();const e=await new Promise(i=>{a.children[0].addEventListener("click",function m(v){v.target.nodeName==="BUTTON"&&(a.children[0].removeEventListener("click",m),i(Number(v.target.innerHTML)))})});return a.close(),e},za=(a,t,e,i)=>{const m=a.legPoints.value[e-1]-t;a.legPoints.value[e-1]=t;for(let v=e-1;v<a.legRemainders.value.length;v++)a.legRemainders.value[v]+=m;a.pointsAndDartsLegs.value[i-1][0]-=m},Za=async(a,t)=>{a.showModal();const i=await new Promise(m=>{a.children[0].addEventListener("click",function v(u){u.target.nodeName==="BUTTON"&&(a.children[0].removeEventListener("click",v),u.target.textContent===" Сохранить матч "&&(Ge().setGame(t),m(!0)),u.target.textContent.trim()==="Не сохранять"&&m(!0),u.target.textContent.trim()==="Отмена"&&m(!1))})});return i||a.close(),i},qa=()=>{const a=c(0),t=c(1),e=c(1),i=c([]),m=p(()=>i.value.reduce((u,n)=>u+n,0));class v{constructor(n,s){$(this,"legRemainders",c([]));$(this,"legPoints",c([]));$(this,"pointsAndDartsLegs",c([]));$(this,"dartsForDoubleSets",c([]));$(this,"p180Sets",c([]));$(this,"p171Sets",c([]));$(this,"p131Sets",c([]));$(this,"p96Sets",c([]));$(this,"averagePointsForFirstNineDartsLegs",c([]));$(this,"highestCheckoutSets",c([]));$(this,"setsWon",c(0));$(this,"legsWonInGame",p(()=>this.pointsAndDartsLegs.value.reduce((n,s)=>s[0]===501?n+1:n,0)));$(this,"legsWonInSet",p(()=>this.pointsAndDartsLegs.value.slice(m.value).reduce((n,s)=>s[0]===501?n+1:n,0)));$(this,"averagePointsLeg",p(()=>{var n,s;return Math.round((((n=this.pointsAndDartsLegs.value[t.value-1])==null?void 0:n[0])/((s=this.pointsAndDartsLegs.value[t.value-1])==null?void 0:s[1])*3||0)*100)/100}));$(this,"gameStatistic",{averagePoints:p(()=>Math.round((this.pointsAndDartsLegs.value.reduce((n,s)=>n+s[0],0)/this.pointsAndDartsLegs.value.reduce((n,s)=>n+s[1],0)*3||0)*100)/100),percentDouble:p(()=>Math.round((this.legsWonInGame.value/this.dartsForDoubleSets.value.reduce((n,s)=>n+s,0)*100||0)*100)/100),p180:p(()=>this.p180Sets.value.reduce((n,s)=>n+s,0)),p171:p(()=>this.p171Sets.value.reduce((n,s)=>n+s,0)),p131:p(()=>this.p131Sets.value.reduce((n,s)=>n+s,0)),p96:p(()=>this.p96Sets.value.reduce((n,s)=>n+s,0)),averageFirstNineDarts:p(()=>Math.round((this.averagePointsForFirstNineDartsLegs.value.reduce((n,s)=>n+s,0)/this.averagePointsForFirstNineDartsLegs.value.length||0)*100)/100),averagePointsWinLegs:p(()=>Math.round((this.legsWonInGame.value*501/this.pointsAndDartsLegs.value.reduce((n,s)=>s[0]===501?n+s[1]:n,0)*3||0)*100)/100),averagePointsLoseLegs:p(()=>{var n,s;return Math.round(((this.pointsAndDartsLegs.value.reduce((l,g)=>g[0]!==501?l+g[0]:l,0)-(((n=this.pointsAndDartsLegs.value[t.value-1])==null?void 0:n[0])||0))/(this.pointsAndDartsLegs.value.reduce((l,g)=>g[0]!==501?l+g[1]:l,0)-(((s=this.pointsAndDartsLegs.value[t.value-1])==null?void 0:s[1])||0))*3||0)*100)/100}),highestCheckout:p(()=>Math.max(...JSON.parse(JSON.stringify(this.highestCheckoutSets.value)),0))});$(this,"setStatistic",{averagePoints:p(()=>Math.round((this.pointsAndDartsLegs.value.slice(m.value).reduce((n,s)=>n+s[0],0)/this.pointsAndDartsLegs.value.slice(m.value).reduce((n,s)=>n+s[1],0)*3||0)*100)/100),percentDouble:p(()=>Math.round((this.legsWonInSet.value/this.dartsForDoubleSets.value[e.value-1]*100||0)*100)/100),p180:p(()=>this.p180Sets.value[e.value-1]||0),p171:p(()=>this.p171Sets.value[e.value-1]||0),p131:p(()=>this.p131Sets.value[e.value-1]||0),p96:p(()=>this.p96Sets.value[e.value-1]||0),averageFirstNineDarts:p(()=>Math.round((this.averagePointsForFirstNineDartsLegs.value.slice(m.value).reduce((n,s)=>n+s,0)/this.averagePointsForFirstNineDartsLegs.value.slice(m.value).length||0)*100)/100),averagePointsWinLegs:p(()=>Math.round((this.legsWonInSet.value*501/this.pointsAndDartsLegs.value.slice(m.value).reduce((n,s)=>s[0]===501?n+s[1]:n,0)*3||0)*100)/100),averagePointsLoseLegs:p(()=>{var n,s;return Math.round(((this.pointsAndDartsLegs.value.slice(m.value).reduce((l,g)=>g[0]!==501?l+g[0]:l,0)-(((n=this.pointsAndDartsLegs.value[t.value-1])==null?void 0:n[0])||0))/(this.pointsAndDartsLegs.value.slice(m.value).reduce((l,g)=>g[0]!==501?l+g[1]:l,0)-(((s=this.pointsAndDartsLegs.value[t.value-1])==null?void 0:s[1])||0))*3||0)*100)/100}),highestCheckout:p(()=>this.highestCheckoutSets.value[e.value-1]||0)});this.name=n,s&&(this.legRemainders.value=s.legRemainders,this.legPoints.value=s.legPoints,this.pointsAndDartsLegs.value=s.pointsAndDartsLegs,this.dartsForDoubleSets.value=s.dartsForDoubleSets,this.p180Sets.value=s.p180Sets,this.p171Sets.value=s.p171Sets,this.p131Sets.value=s.p131Sets,this.p96Sets.value=s.p96Sets,this.averagePointsForFirstNineDartsLegs.value=s.averagePointsForFirstNineDartsLegs,this.highestCheckoutSets.value=s.highestCheckoutSets,this.setsWon.value=s.setsWon)}clearPointsAndRemaindersLeg(){this.legRemainders.value=[],this.legPoints.value=[]}setInPointsAndDartsLegs(n,s,l){this.pointsAndDartsLegs.value[l-1]||(this.pointsAndDartsLegs.value[l-1]=[0,0]),this.pointsAndDartsLegs.value[l-1][0]+=n,this.pointsAndDartsLegs.value[l-1][1]+=s}checkAndSetHighPoints(n){var s,l,g,N,W,M,R,f;n===180&&((s=this.p180Sets.value)[l=e.value-1]??(s[l]=0),this.p180Sets.value[e.value-1]++),n>=171&&n<180&&((g=this.p171Sets.value)[N=e.value-1]??(g[N]=0),this.p171Sets.value[e.value-1]++),n>=131&&n<171&&((W=this.p131Sets.value)[M=e.value-1]??(W[M]=0),this.p131Sets.value[e.value-1]++),n>=96&&n<131&&((R=this.p96Sets.value)[f=e.value-1]??(R[f]=0),this.p96Sets.value[e.value-1]++)}checkAndSetHighestCheckout(){var n,s;(n=this.highestCheckoutSets.value)[s=e.value-1]??(n[s]=0),this.legRemainders.value.at(-1)>this.highestCheckoutSets.value[e.value-1]&&(this.highestCheckoutSets.value[e.value-1]=this.legRemainders.value.at(-1))}setAveragePointsForFirstNineDarts(){this.averagePointsForFirstNineDartsLegs.value[t.value-1]=Math.round(this.pointsAndDartsLegs.value[t.value-1][0]/this.pointsAndDartsLegs.value[t.value-1][1]*3*100)/100}}return{Player:v,startRemainder:a,legNumber:t,setNumber:e,legNumberInSets:i}};const Qa={class:"page game-page game"},Xa={class:"game__players-information players-information"},Ya={class:"players-information__name players-information__name_position-left"},es={class:"darts-icon-wrapper"},ts=["src"],as={class:"players-information__name players-information__name_position-right"},ss={class:"game__points-information points-information"},ns={class:"points-information__points points"},rs={class:"points__round-information round-information"},is=o("div",{class:"round-information__points-area round-information__points-area_margin-right"},null,-1),os=o("div",{class:"round-information__number-darts"},null,-1),ls=o("div",{class:"round-information__points-area round-information__points-area_margin-right"},null,-1),us={__name:"GamePage",setup(a){const t=Z({loader:()=>q(()=>import("./gameOver-7f216771.js"),["assets/gameOver-7f216771.js","assets/index-5dc47f3f.js","assets/index-196bc00e.css","assets/fetch-7e6a8300.js","assets/fetch-5382e2d8.css","assets/homeButton-8b356e28.js","assets/homeButton-875e117f.css","assets/close-ed01941b.js","assets/gameOver-741ad040.css"]),loadingComponent:ja,delay:0}),e=Fe(),i=j(),m=c(null),v=c(!1),u=c(!0),n=c(!0),s=c(""),l=c(null),g=c(null),N=c(!1),W=c(!1);Me(()=>{g.value.showModal()});const{Player:M,startRemainder:R,legNumber:f,setNumber:y,legNumberInSets:w}=qa();let I,P,S;const x=Ge();x.savedGame&&(I=x.savedGame.gameParameters,R.value=x.savedGame.startRemainder,P=new M(x.savedGame.playerOne.name,x.savedGame.playerOne),S=new M(x.savedGame.playerTwo.name,x.savedGame.playerTwo),f.value=x.savedGame.legNumber,y.value=x.savedGame.setNumber,w.value=x.savedGame.legNumberInSets,x.resetGame(),W.value=!0,setTimeout(()=>Y(P.legPoints.value.length===S.legPoints.value.length?"playerTwo":"playerOne",document.forms[0]),0));const De=A=>{I=A,R.value=I.startRemainder,P=new M(I.nameP1),S=new M(I.nameP2),W.value=!0,g.value.close(),fe(f.value,y.value,document.forms[0])},Le=async(A,_,B,O)=>{var U,E;const L=B==="playerOne"?P:S;if(O<=L.legRemainders.value.length){za(L,A,O,f.value),Y(B,document.forms[0]);return}if(_<=50&&(B==="playerOne"&&I.isPercentDoubleInStatP1||B==="playerTwo"&&I.isPercentDoubleInStatP2)){v.value=!0,s.value="Количество дротиков на удвоение";const X=await se(m.value);v.value=!1,(U=L.dartsForDoubleSets.value)[E=y.value-1]??(U[E]=0),L.dartsForDoubleSets.value[y.value-1]+=X}L.checkAndSetHighPoints(A),L.legPoints.value.push(A),L.legRemainders.value.push(_),L.setInPointsAndDartsLegs(A,3,f.value),L.pointsAndDartsLegs.value[f.value-1][1]===9&&L.setAveragePointsForFirstNineDarts(),Y(B,document.forms[0])},$e=async A=>{var U,E;const _=A==="playerOne"?P:S,B=A==="playerOne"?S:P;let O;_.legRemainders.value.at(-1)>100&&_.legRemainders.value.at(-1)!==110&&(O=3),O||(s.value="Количество дротиков в подходе",_.legRemainders.value.at(-1)>40&&_.legRemainders.value.at(-1)!==50&&(u.value=!1),O=await se(m.value),u.value=!0);let L;if((A==="playerOne"&&I.isPercentDoubleInStatP1||A==="playerTwo"&&I.isPercentDoubleInStatP2)&&(_.legRemainders.value.at(-1)>100&&_.legRemainders.value.at(-1)!==110&&(L=1),L||(s.value="Количество дротиков на удвоение",_.legRemainders.value.at(-1)>40&&_.legRemainders.value.at(-1)!==50&&(n.value=!1),L=await se(m.value),n.value=!0)),_.setInPointsAndDartsLegs(_.legRemainders.value.at(-1),O,f.value),_.pointsAndDartsLegs.value[f.value-1][1]===9&&(_.setAveragePointsForFirstNineDarts(),B.pointsAndDartsLegs.value[f.value-1][1]===6&&B.setAveragePointsForFirstNineDarts()),(A==="playerOne"&&I.isPercentDoubleInStatP1||A==="playerTwo"&&I.isPercentDoubleInStatP2)&&((U=_.dartsForDoubleSets.value)[E=y.value-1]??(U[E]=0),_.dartsForDoubleSets.value[y.value-1]+=L),_.checkAndSetHighestCheckout(),_.checkAndSetHighPoints(_.legRemainders.value.at(-1)),_.legsWonInSet.value===I.legsToWin&&(w.value.push(P.legsWonInSet.value+S.legsWonInSet.value),_.setsWon.value++,y.value++),P.clearPointsAndRemaindersLeg(),S.clearPointsAndRemaindersLeg(),_.setsWon.value===I.setsToWin){N.value=!0,l.value.showModal(),f.value++;return}f.value++,fe(f.value,y.value,document.forms[0])},oe=()=>{f.value=1,y.value=1,R.value=0,w.value=[],l.value.close(),N.value=!1,W.value=!1,g.value.showModal(),P=void 0,S=void 0},Ae=He();let le=!1;const ue=c(null);return Ue(A=>{const _=async()=>{await Za(ue.value,{gameParameters:I,startRemainder:R,playerOne:P,playerTwo:S,legNumber:f,setNumber:y,legNumberInSets:w})?(le=!0,Ae.push(A.fullPath)):Y(P.legPoints.value.length===S.legPoints.value.length?"playerTwo":"playerOne",document.forms[0])};if((f.value>1||(P==null?void 0:P.legPoints.value[0])!==void 0||(S==null?void 0:S.legPoints.value[0])!==void 0)&&W.value&&!N.value&&!le)return _(),!1}),(A,_)=>{var B,O,L,U,E,X,me,ce,de,ge,ve,pe,_e,Pe;return d(),h(H,null,[o("dialog",{class:"dialog",ref_key:"gameSetupModal",ref:g,onCancel:_[0]||(_[0]=z(()=>{},["prevent"]))},[W.value?b("",!0):(d(),D(Ot,{key:0,onStartGame:De}))],544),o("main",Qa,[o("button",{class:"game__new-game-button",onClick:oe}," Новый матч "),G(je),o("div",Xa,[o("div",Ya,C(((B=r(i).users.P1)==null?void 0:B.name)||((O=r(P))==null?void 0:O.name)),1),Boolean(r(P))?(d(),D(ye,{key:0,areSetsInGame:(L=r(I))==null?void 0:L.areSetsInGame,setsWon:(U=r(P))==null?void 0:U.setsWon.value,legsWonInSet:(E=r(P))==null?void 0:E.legsWonInSet.value,player:"P1"},null,8,["areSetsInGame","setsWon","legsWonInSet"])):b("",!0),o("div",es,[r(e).svg.darts?(d(),h("img",{key:0,class:"darts-icon",src:r(e).svg.darts,alt:"darts"},null,8,ts)):b("",!0)]),Boolean(r(S))?(d(),D(ye,{key:1,areSetsInGame:(X=r(I))==null?void 0:X.areSetsInGame,setsWon:(me=r(S))==null?void 0:me.setsWon.value,legsWonInSet:(ce=r(S))==null?void 0:ce.legsWonInSet.value,player:"P2"},null,8,["areSetsInGame","setsWon","legsWonInSet"])):b("",!0),o("div",as,C(((de=r(i).users.P2)==null?void 0:de.name)||((ge=r(S))==null?void 0:ge.name)),1)]),o("div",ss,[Boolean(r(P))?(d(),D(be,{key:0,player:"P1",gameStatistic:r(P).gameStatistic,setStatistic:r(P).setStatistic,averagePointsLeg:r(P).averagePointsLeg.value,areSetsInGame:(ve=r(I))==null?void 0:ve.areSetsInGame,isPercentDoubleInStat:(pe=r(I))==null?void 0:pe.isPercentDoubleInStatP1},null,8,["gameStatistic","setStatistic","averagePointsLeg","areSetsInGame","isPercentDoubleInStat"])):b("",!0),o("form",ns,[o("div",rs,[is,K(o("div",{class:"round-information__remainder"},C(r(R)),513),[[J,W.value]]),os,K(o("div",{class:"round-information__remainder"},C(r(R)),513),[[J,W.value]]),ls]),r(P)&&r(S)?(d(!0),h(H,{key:0},ee(Math.max(r(P).legRemainders.value.length,r(S).legRemainders.value.length)+1,T=>(d(),h(H,{key:T+"line"},[(!(T-1)||r(P).legRemainders.value[T-2]&&r(S).legRemainders.value[T-2])&&W.value&&!N.value?(d(),D(jt,{key:0,remainderBeforeGetPointsP1:T-1?r(P).legRemainders.value[T-2]:r(R),remainderBeforeGetPointsP2:T-1?r(S).legRemainders.value[T-2]:r(R),remainderAfterGetPointsP1:r(P).legRemainders.value[T-1],remainderAfterGetPointsP2:r(S).legRemainders.value[T-1],roundPointsP1:r(P).legPoints.value[T-1],roundPointsP2:r(S).legPoints.value[T-1],roundNumber:T,legNumber:r(f),setNumber:r(y),onSetPointsAndRemainder:Le,onLegCompleted:$e},null,8,["remainderBeforeGetPointsP1","remainderBeforeGetPointsP2","remainderAfterGetPointsP1","remainderAfterGetPointsP2","roundPointsP1","roundPointsP2","roundNumber","legNumber","setNumber"])):b("",!0)],64))),128)):b("",!0)]),Boolean(r(S))?(d(),D(be,{key:1,player:"P2",gameStatistic:r(S).gameStatistic,setStatistic:r(S).setStatistic,averagePointsLeg:r(S).averagePointsLeg.value,areSetsInGame:(_e=r(I))==null?void 0:_e.areSetsInGame,isPercentDoubleInStat:(Pe=r(I))==null?void 0:Pe.isPercentDoubleInStatP2},null,8,["gameStatistic","setStatistic","averagePointsLeg","areSetsInGame","isPercentDoubleInStat"])):b("",!0)])]),o("dialog",{class:"dialog",ref_key:"numberDartsModal",ref:m,onCancel:_[1]||(_[1]=z(()=>{},["prevent"]))},[G(Zt,{message:s.value,seenZero:v.value,seenOne:u.value,seenThree:n.value},null,8,["message","seenZero","seenOne","seenThree"])],544),o("dialog",{class:"dialog",ref_key:"beforeLeavePage",ref:ue,onCancel:_[2]||(_[2]=z(()=>{},["prevent"]))},[G(ta)],544),o("dialog",{class:"dialog",ref_key:"gameOverModal",ref:l,onCancel:_[3]||(_[3]=z(()=>{},["prevent"]))},[N.value?(d(),D(r(t),{key:0,onStartNewGame:oe,nameP1:r(P).name,nameP2:r(S).name,wonP1:r(I).areSetsInGame?r(P).setsWon.value:r(P).legsWonInGame.value,wonP2:r(I).areSetsInGame?r(S).setsWon.value:r(S).legsWonInGame.value,legsWonInGameP1:r(P).legsWonInGame.value,legsWonInGameP2:r(S).legsWonInGame.value,gameStatisticP1:r(P).gameStatistic,gameStatisticP2:r(S).gameStatistic,isPercentDoubleInStatP1:r(I).isPercentDoubleInStatP1,isPercentDoubleInStatP2:r(I).isPercentDoubleInStatP2,legNumber:r(f)-1},null,8,["nameP1","nameP2","wonP1","wonP2","legsWonInGameP1","legsWonInGameP2","gameStatisticP1","gameStatisticP2","isPercentDoubleInStatP1","isPercentDoubleInStatP2","legNumber"])):b("",!0)],544)],64)}}},ps=Object.freeze(Object.defineProperty({__proto__:null,default:us},Symbol.toStringTag,{value:"Module"}));export{ps as G,na as _,re as a,ie as b};
